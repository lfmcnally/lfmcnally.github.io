<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>15-Mark Answer Builder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #0066ff 0%, #4d94ff 25%, #e6f0ff 60%, #ffffff 100%);
            background-attachment: fixed;
            min-height: 100vh;
            color: #333;
            padding: 1.5rem;
        }

        .header {
            text-align: center;
            padding: 1rem;
            color: white;
            margin-bottom: 1.5rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        .question-box {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 0.5rem;
        }

        .question-input {
            width: 100%;
            font-size: 1.3rem;
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            background: white;
            font-family: inherit;
            text-align: center;
        }

        .question-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .marks {
            font-size: 1rem;
            color: #666;
            font-weight: 500;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            max-width: 1600px;
            margin: 0 auto 1.5rem;
        }

        .panel {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .panel-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid rgba(0, 102, 255, 0.2);
        }

        .latin-text {
            font-size: 1.15rem;
            line-height: 2;
            color: #1a1a1a;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(0, 102, 255, 0.02);
            border-radius: 8px;
            border-left: 4px solid #0066ff;
            user-select: text;
        }

        .translation {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #555;
            font-style: italic;
            padding: 1rem;
            background: rgba(230, 240, 255, 0.5);
            border-radius: 8px;
        }

        .builder-section {
            max-height: 75vh;
            overflow-y: auto;
        }

        .structure-guide {
            background: linear-gradient(135deg, #4CAF50 0%, #66BB6A 100%);
            color: white;
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .structure-guide strong {
            display: block;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .technique-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: white;
            border: 2px dashed rgba(0, 102, 255, 0.3);
            border-radius: 12px;
        }

        .bank-label {
            width: 100%;
            font-size: 0.8rem;
            font-weight: 600;
            color: #0066ff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .technique-tile {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: grab;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .technique-tile:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .technique-tile:active {
            cursor: grabbing;
        }

        .technique-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            background: rgba(0, 102, 255, 0.05);
            cursor: not-allowed;
        }

        .technique-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .answer-slot {
            background: white;
            border: 2px solid rgba(0, 102, 255, 0.15);
            border-radius: 12px;
            padding: 1.25rem;
            margin-bottom: 1rem;
        }

        .slot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .slot-number {
            font-weight: 600;
            color: #0066ff;
            font-size: 1rem;
        }

        .clear-slot {
            background: transparent;
            border: 1px solid #ccc;
            color: #666;
            padding: 0.3rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clear-slot:hover {
            background: #f5f5f5;
            border-color: #999;
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #555;
            margin-bottom: 0.5rem;
            display: block;
        }

        .step-number {
            background: #0066ff;
            color: white;
            padding: 0.15rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-right: 0.5rem;
        }

        .technique-drop {
            min-height: 45px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .technique-drop.active {
            border-color: #0066ff;
            background: rgba(0, 102, 255, 0.05);
        }

        .technique-drop.filled {
            border-style: solid;
            border-color: #FF6B6B;
            background: rgba(255, 107, 107, 0.1);
        }

        .drop-placeholder {
            font-size: 0.85rem;
            color: #999;
        }

        .latin-input, .translation-input {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
        }

        .latin-input:focus, .translation-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .translation-input {
            font-style: italic;
            color: #555;
            font-size: 0.9rem;
        }

        .passage-input {
            width: 100%;
            min-height: 200px;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            resize: none;
            line-height: 1.8;
            overflow: hidden;
        }

        .passage-input:focus {
            outline: none;
            border-color: #0066ff;
        }

        .passage-input:disabled {
            background: rgba(0, 102, 255, 0.02);
            cursor: not-allowed;
        }

        .lock-btn {
            background: #0066ff;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 0.5rem;
            transition: all 0.2s ease;
        }

        .lock-btn:hover {
            background: #0052cc;
        }

        .lock-btn.locked {
            background: #4CAF50;
        }

        .sentence-starter {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            background: white;
            cursor: pointer;
        }

        .sentence-starter:focus {
            outline: none;
            border-color: #0066ff;
        }

        .technique-select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            background: white;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }

        .technique-select:focus {
            outline: none;
            border-color: #0066ff;
        }

        .analysis-textarea {
            width: 100%;
            min-height: 150px;
            padding: 0.75rem;
            border: 2px solid rgba(0, 102, 255, 0.2);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            resize: vertical;
            line-height: 1.6;
        }

        .analysis-textarea:focus {
            outline: none;
            border-color: #0066ff;
        }

        .char-counter {
            text-align: right;
            font-size: 0.75rem;
            color: #666;
            margin-top: 0.25rem;
        }

        .bank-button {
            width: 100%;
            padding: 0.75rem;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 0.75rem;
        }

        .bank-button:hover {
            background: #45a049;
            transform: translateY(-1px);
        }

        .bank-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .add-slot-btn {
            width: 100%;
            padding: 0.75rem;
            background: #0066ff;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 0.5rem;
        }

        .answer-display {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-width: 1600px;
            margin: 0 auto;
        }

        .banked-point {
            background: white;
            border: 1px solid rgba(0, 102, 255, 0.15);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .point-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0, 102, 255, 0.1);
        }

        .point-label {
            font-weight: 600;
            color: #0066ff;
            font-size: 0.9rem;
        }

        .point-actions {
            display: flex;
            gap: 0.5rem;
        }

        .action-btn {
            background: transparent;
            border: 1px solid #ccc;
            color: #666;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .action-btn:hover {
            background: #f5f5f5;
            border-color: #999;
        }

        .point-content {
            font-size: 0.95rem;
            line-height: 1.7;
            color: #333;
        }

        .total-words {
            text-align: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid rgba(0, 102, 255, 0.2);
            font-weight: 600;
            color: #0066ff;
        }

        .export-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.2s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .export-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #999;
            font-style: italic;
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">Classicalia</div>
        <div class="subtitle">15-Mark Answer Builder</div>
    </header>

    <div class="question-box">
        <input type="text" id="questionInput" class="question-input" placeholder="Type or paste your 15-mark question here..." value="How does Tacitus create a dramatic account of Britannicus' poisoning?">
        <div class="marks">[15 marks]</div>
    </div>

    <div class="main-grid">
        <div class="panel">
            <h3 class="panel-title">Latin Passage</h3>
            
            <div class="input-group">
                <label class="input-label">Paste your Latin text:</label>
                <textarea id="latinTextInput" class="passage-input" placeholder="Paste your Latin passage here..." oninput="autoResize(this)">epulanti Britannicoâ€”nam proprium adhuc mensam et adstantem habebatâ€”haustum poculi per ministros suos adlatum, ubi gustu temperantis eius probabat, additur venenum. ac perinde vocis et spiritus eius pavor obturbat convivas: pars imprudentes trepidavere, sagaciores manebant defixi et Neronem intuentes. at ille, ut erat reclinis et nescio similis, solitum ita ait per comitialem morbum, quo prima ab infantia adflictaretur Britannicus, et redituros paulatim visus sensusque.</textarea>
                <button class="lock-btn" id="lockLatinBtn" onclick="toggleLock('latin')">ðŸ”“ Click to Lock</button>
            </div>

            <div class="input-group">
                <label class="input-label">Paste your translation:</label>
                <textarea id="translationInput" class="passage-input" placeholder="Paste your English translation here..." oninput="autoResize(this)">While Britannicus was diningâ€”for he still had his own separate table and attendantâ€”a drink from a cup was brought to him by his servants, when the taster proved with his taste that it was harmless, poison was added. And at once the convulsions of his voice and breathing disturbed the guests: some unaware panicked, the shrewder ones remained frozen and watching Nero. But he, as he was reclining and pretending not to know, said it was usual because of the epilepsy, by which Britannicus had been afflicted from earliest infancy, and that his sight and senses would gradually return.</textarea>
                <button class="lock-btn" id="lockTransBtn" onclick="toggleLock('translation')">ðŸ”“ Click to Lock</button>
            </div>
        </div>

        <div class="panel builder-section">
            <h3 class="panel-title">Build Your Answer</h3>

            <div class="structure-guide">
                <strong>Answer Structure Formula:</strong>
                Tacitus uses [TECHNIQUE] with "[Latin]" (translation). [SENTENCE STARTER] [effect explanation]
            </div>

            <div class="input-group">
                <label class="input-label">Select a stylistic technique:</label>
                <select id="techniqueSelect" class="technique-select" onchange="copyTechniqueToSlots()">
                    <option value="">Choose a technique...</option>
                    <option value="Asyndeton">Asyndeton - omission of conjunctions (no 'and', 'but')</option>
                    <option value="Polysyndeton">Polysyndeton - repeated conjunctions (lots of 'and', 'et')</option>
                    <option value="Tricolon">Tricolon - three parallel phrases or clauses</option>
                    <option value="Anaphora">Anaphora - repetition of words at start of clauses</option>
                    <option value="Chiasmus">Chiasmus - ABBA structure (reversed word order)</option>
                    <option value="Hyperbaton">Hyperbaton - unusual/separated word order</option>
                    <option value="Word order/delay">Word order/delay - key word held back for emphasis</option>
                    <option value="Vivid imagery">Vivid imagery - descriptive, sensory language</option>
                    <option value="Irony">Irony - contrast between appearance and reality</option>
                    <option value="Contrast">Contrast - opposing ideas/words placed together</option>
                    <option value="Antithesis">Antithesis - direct opposites balanced against each other</option>
                    <option value="Brevity">Brevity - short, clipped expression</option>
                    <option value="Hyperbole">Hyperbole - exaggeration for effect</option>
                    <option value="Loaded vocabulary">Loaded vocabulary - emotionally charged words</option>
                    <option value="Metaphor">Metaphor - implicit comparison</option>
                    <option value="Simile">Simile - explicit comparison (using 'like')</option>
                    <option value="Personification">Personification - human qualities to non-human things</option>
                    <option value="Alliteration">Alliteration - repeated consonant sounds</option>
                    <option value="Sibilance">Sibilance - repeated 's' sounds</option>
                    <option value="Rhetorical question">Rhetorical question - question for effect, not answer</option>
                    <option value="Direct speech">Direct speech - character's actual words quoted</option>
                    <option value="Indirect speech">Indirect speech - reported speech</option>
                    <option value="Historic present">Historic present - present tense for past events</option>
                    <option value="Historic infinitive">Historic infinitive - infinitive for past narration</option>
                    <option value="Passive voice">Passive voice - subject receives the action</option>
                    <option value="Zeugma">Zeugma - one verb governing multiple objects</option>
                </select>
            </div>

            <div id="slotsContainer"></div>

            <button class="add-slot-btn" onclick="addSlot()">+ Add Another Point</button>
        </div>
    </div>

    <div class="answer-display">
        <h3 class="panel-title">Your Complete Answer</h3>
        <div id="answerDisplay">
            <div class="empty-state">Your banked points will appear here...</div>
        </div>
        <div class="total-words" id="totalWords" style="display: none;"></div>
        <button class="export-btn" id="exportBtn" onclick="exportToPDF()" disabled>ðŸ“„ Export to PDF</button>
    </div>

    <script>
        let slotCount = 0;
        let bankedPoints = [];

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        window.addEventListener('load', function() {
            autoResize(document.getElementById('latinTextInput'));
            autoResize(document.getElementById('translationInput'));
        });

        function copyTechniqueToSlots() {
            const select = document.getElementById('techniqueSelect');
            const selectedValue = select.value;
            
            if (selectedValue) {
                const slots = document.querySelectorAll('.technique-input');
                slots.forEach(slot => {
                    if (slot.value === '') {
                        slot.value = selectedValue;
                        checkBankButton(slot.closest('.answer-slot'));
                    }
                });
            }
        }

        function toggleLock(type) {
            if (type === 'latin') {
                const input = document.getElementById('latinTextInput');
                const btn = document.getElementById('lockLatinBtn');
                input.disabled = !input.disabled;
                if (input.disabled) {
                    btn.textContent = 'ðŸ”’ Locked';
                    btn.classList.add('locked');
                } else {
                    btn.textContent = 'ðŸ”“ Click to Lock';
                    btn.classList.remove('locked');
                }
            } else {
                const input = document.getElementById('translationInput');
                const btn = document.getElementById('lockTransBtn');
                input.disabled = !input.disabled;
                if (input.disabled) {
                    btn.textContent = 'ðŸ”’ Locked';
                    btn.classList.add('locked');
                } else {
                    btn.textContent = 'ðŸ”“ Click to Lock';
                    btn.classList.remove('locked');
                }
            }
        }

        function createSlot() {
            slotCount++;
            const slotId = 'slot' + slotCount;
            
            const slot = document.createElement('div');
            slot.className = 'answer-slot';
            slot.id = slotId;
            slot.innerHTML = '<div class="slot-header"><span class="slot-number">Point ' + slotCount + '</span><button class="clear-slot" onclick="clearSlot(\'' + slotId + '\')">Clear</button></div><div class="input-group"><label class="input-label"><span class="step-number">1</span> Technique (auto-filled from dropdown):</label><input type="text" class="technique-input" placeholder="Select from dropdown above" data-slot="' + slotId + '" readonly></div><div class="input-group"><label class="input-label"><span class="step-number">2</span> Copy your Latin quote from passage:</label><input type="text" class="latin-input" placeholder="e.g., haustum... venenum" data-slot="' + slotId + '"></div><div class="input-group"><label class="input-label"><span class="step-number">3</span> Add translation in brackets:</label><input type="text" class="translation-input" placeholder="e.g., the drink... poison" data-slot="' + slotId + '"></div><div class="input-group"><label class="input-label"><span class="step-number">4</span> Choose a sentence starter:</label><select class="sentence-starter" data-slot="' + slotId + '"><option value="">Select...</option><option value="This creates">This creates</option><option value="This emphasizes">This emphasizes</option><option value="This suggests">This suggests</option><option value="This highlights">This highlights</option><option value="This conveys">This conveys</option><option value="This reveals">This reveals</option></select></div><div class="input-group"><label class="input-label"><span class="step-number">5</span> Explain the effect:</label><textarea class="analysis-textarea" placeholder="Explain the dramatic effect...\n\nExample: dramatic suspense by holding back the critical word until the end, making the reader experience the sudden shock of the poisoning." data-slot="' + slotId + '"></textarea><div class="char-counter">0 characters</div></div><button class="bank-button" onclick="bankPoint(\'' + slotId + '\')" disabled>Bank This Point</button>';

            return slot;
        }

        function addSlot() {
            const container = document.getElementById('slotsContainer');
            const slot = createSlot();
            container.appendChild(slot);
            setupValidation(slot);
        }

        function setupValidation(slot) {
            const textarea = slot.querySelector('.analysis-textarea');
            const counter = slot.querySelector('.char-counter');
            const latinInput = slot.querySelector('.latin-input');
            const translationInput = slot.querySelector('.translation-input');
            const techniqueInput = slot.querySelector('.technique-input');
            const sentenceStarter = slot.querySelector('.sentence-starter');

            textarea.addEventListener('input', function() {
                const charCount = this.value.length;
                const wordCount = this.value.trim().split(/\s+/).length;
                counter.textContent = charCount + ' characters (~' + wordCount + ' words)';
                checkBankButton(slot);
            });

            latinInput.addEventListener('input', () => checkBankButton(slot));
            translationInput.addEventListener('input', () => checkBankButton(slot));
            techniqueInput.addEventListener('input', () => checkBankButton(slot));
            sentenceStarter.addEventListener('change', () => checkBankButton(slot));
        }

        function checkBankButton(slot) {
            const button = slot.querySelector('.bank-button');
            const latinInput = slot.querySelector('.latin-input');
            const translationInput = slot.querySelector('.translation-input');
            const techniqueInput = slot.querySelector('.technique-input');
            const sentenceStarter = slot.querySelector('.sentence-starter');
            const textarea = slot.querySelector('.analysis-textarea');

            const hasTechnique = techniqueInput.value.trim().length > 0;
            const hasLatin = latinInput.value.trim().length > 0;
            const hasTranslation = translationInput.value.trim().length > 0;
            const hasStarter = sentenceStarter.value !== '';
            const hasEffect = textarea.value.trim().length > 20;

            button.disabled = !(hasTechnique && hasLatin && hasTranslation && hasStarter && hasEffect);
        }

        function bankPoint(slotId) {
            const slot = document.getElementById(slotId);
            const technique = slot.querySelector('.technique-input').value;
            const latin = slot.querySelector('.latin-input').value;
            const translation = slot.querySelector('.translation-input').value;
            const starter = slot.querySelector('.sentence-starter').value;
            const effect = slot.querySelector('.analysis-textarea').value;

            const fullPoint = 'Tacitus uses ' + technique + ' with "' + latin + '" (' + translation + '). ' + starter + ' ' + effect;

            const pointNumber = bankedPoints.length + 1;
            bankedPoints.push({ fullPoint, pointNumber });

            updateAnswerDisplay();
            clearSlot(slotId);
        }

        function clearSlot(slotId) {
            const slot = document.getElementById(slotId);
            slot.querySelector('.technique-input').value = '';
            slot.querySelector('.latin-input').value = '';
            slot.querySelector('.translation-input').value = '';
            slot.querySelector('.sentence-starter').value = '';
            slot.querySelector('.analysis-textarea').value = '';
            slot.querySelector('.char-counter').textContent = '0 characters';
            slot.querySelector('.bank-button').disabled = true;
        }

        function updateAnswerDisplay() {
            const display = document.getElementById('answerDisplay');
            const totalWords = document.getElementById('totalWords');

            if (bankedPoints.length === 0) {
                display.innerHTML = '<div class="empty-state">Your banked points will appear here...</div>';
                totalWords.style.display = 'none';
                return;
            }

            let html = '';
            let wordCount = 0;

            bankedPoints.forEach((point, index) => {
                const words = point.fullPoint.trim().split(/\s+/).length;
                wordCount += words;

                html += '<div class="banked-point"><div class="point-header"><span class="point-label">Point ' + point.pointNumber + '</span><div class="point-actions"><button class="action-btn" onclick="moveUp(' + index + ')">â–²</button><button class="action-btn" onclick="moveDown(' + index + ')">â–¼</button><button class="action-btn" onclick="removePoint(' + index + ')">âœ•</button></div></div><div class="point-content">' + point.fullPoint + '</div></div>';
            });

            display.innerHTML = html;
            totalWords.textContent = 'Total: ' + bankedPoints.length + ' points, ~' + wordCount + ' words';
            totalWords.style.display = 'block';
            
            document.getElementById('exportBtn').disabled = false;
        }

        function moveUp(index) {
            if (index > 0) {
                const temp = bankedPoints[index];
                bankedPoints[index] = bankedPoints[index - 1];
                bankedPoints[index - 1] = temp;
                updateAnswerDisplay();
            }
        }

        function moveDown(index) {
            if (index < bankedPoints.length - 1) {
                const temp = bankedPoints[index];
                bankedPoints[index] = bankedPoints[index + 1];
                bankedPoints[index + 1] = temp;
                updateAnswerDisplay();
            }
        }

        function removePoint(index) {
            bankedPoints.splice(index, 1);
            updateAnswerDisplay();
            if (bankedPoints.length === 0) {
                document.getElementById('exportBtn').disabled = true;
            }
        }

        function exportToPDF() {
            const question = document.getElementById('questionInput').value;
            const date = new Date().toLocaleDateString('en-GB', { 
                day: 'numeric', 
                month: 'long', 
                year: 'numeric' 
            });

            const printWindow = window.open('', '', 'width=800,height=600');
            
            let htmlContent = '<!DOCTYPE html><html><head><title>Latin Answer</title><style>';
            htmlContent += 'body { font-family: "Times New Roman", Times, serif; margin: 2cm; line-height: 1.6; color: #000; }';
            htmlContent += '.date { text-align: right; margin-bottom: 1cm; font-size: 12pt; }';
            htmlContent += '.question { font-weight: bold; font-size: 14pt; margin-bottom: 1cm; text-align: center; }';
            htmlContent += '.answer { font-size: 12pt; text-align: justify; }';
            htmlContent += '.paragraph { margin-bottom: 1em; text-indent: 0; }';
            htmlContent += '@media print { body { margin: 2cm; } }';
            htmlContent += '</style></head><body>';
            
            htmlContent += '<div class="date">' + date + '</div>';
            htmlContent += '<div class="question">' + question + '</div>';
            htmlContent += '<div class="answer">';
            
            bankedPoints.forEach(point => {
                htmlContent += '<div class="paragraph">' + point.fullPoint + '</div>';
            });
            
            htmlContent += '</div></body></html>';
            
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            printWindow.onload = function() {
                printWindow.focus();
                printWindow.print();
            };
        }

        addSlot();
    </script>
</body>
</html>
