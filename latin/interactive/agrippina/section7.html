<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classicalia - Tacitus Annals 14.7</title>
    <link rel="icon" type="image/png" href="/images/favicon.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif; background: #f8f9fa; min-height: 100vh; display: flex; }
        .sidebar { width: 240px; background: white; border-right: 1px solid #e5e7eb; position: fixed; height: 100vh; overflow-y: auto; z-index: 100; }
        .logo-section { padding: 1.5rem 1.25rem; border-bottom: 1px solid #e5e7eb; }
        .logo { display: flex; align-items: center; gap: 0.75rem; text-decoration: none; }
        .logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, #0066ff 0%, #4d94ff 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; color: white; font-size: 1.1rem; }
        .logo-text { font-size: 1.25rem; font-weight: 700; color: #1f2937; }
        .nav-section { padding: 1rem 0.5rem; }
        .nav-title { font-size: 0.7rem; font-weight: 600; text-transform: uppercase; color: #9ca3af; letter-spacing: 0.05em; padding: 0 0.75rem; margin-bottom: 0.5rem; }
        .nav-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.625rem 0.75rem; margin: 0.125rem 0; border-radius: 8px; text-decoration: none; color: #4b5563; font-size: 0.9rem; transition: all 0.15s ease; cursor: pointer; }
        .nav-item:hover { background: #f3f4f6; color: #1f2937; }
        .nav-item.active { background: #eef2ff; color: #0066ff; font-weight: 500; }
        .nav-icon { width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 1.1rem; }
        .main-content { margin-left: 240px; flex: 1; display: flex; flex-direction: column; }
        .top-bar { background: white; border-bottom: 1px solid #e5e7eb; padding: 0.875rem 2rem; position: sticky; top: 0; z-index: 50; }
        .content-wrapper { flex: 1; overflow-y: auto; }
        .content-container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
        .lesson-header { margin-bottom: 2rem; }
        .lesson-title { font-size: 2rem; font-weight: 700; color: #1f2937; margin-bottom: 0.5rem; }
        .lesson-meta { display: flex; gap: 1.5rem; font-size: 0.875rem; color: #6b7280; }
        .card { background: white; border-radius: 12px; border: 1px solid #e5e7eb; overflow: hidden; }
        .card-header { padding: 1.25rem 1.5rem; border-bottom: 1px solid #e5e7eb; display: flex; align-items: center; justify-content: space-between; }
        .card-title { font-size: 1.125rem; font-weight: 600; color: #1f2937; }
        .card-body { padding: 2rem; }
        .latin-text { font-size: 1.5rem; line-height: 2.4; color: #1f2937; }
        .word { cursor: pointer; padding: 2px 4px; margin: 0 1px; border-radius: 4px; transition: all 0.15s ease; display: inline; }
        .word:hover { background: rgba(0, 102, 255, 0.15); }
        .word.active { background: rgba(0, 102, 255, 0.25); }
        .vocab-popup { position: fixed; background: white; border-radius: 10px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(0, 0, 0, 0.05); padding: 1rem 1.25rem; z-index: 1000; max-width: 350px; min-width: 250px; display: none; animation: popIn 0.2s ease; }
        .vocab-popup::before { content: ''; position: absolute; top: -8px; left: var(--arrow-left, 50%); transform: translateX(-50%); border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 8px solid white; }
        .vocab-popup.arrow-bottom::before { top: auto; bottom: -8px; border-bottom: none; border-top: 8px solid white; }
        @keyframes popIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        .vocab-popup.visible { display: block; }
        .vocab-popup h4 { font-size: 1.1rem; font-weight: 600; color: #0066ff; margin-bottom: 0.5rem; }
        .vocab-popup .parsing { font-size: 0.8rem; color: #6b7280; margin-bottom: 0.5rem; font-style: italic; }
        .vocab-popup .meaning { font-size: 0.95rem; color: #1f2937; line-height: 1.5; }
        .vocab-popup .principal-parts { font-size: 0.85rem; color: #4b5563; margin-top: 0.5rem; padding-top: 0.5rem; border-top: 1px solid #e5e7eb; }
        .btn-group { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1.5rem; }
        .btn { padding: 0.625rem 1rem; border: 1px solid #e5e7eb; background: white; border-radius: 8px; font-size: 0.8rem; font-weight: 500; color: #374151; cursor: pointer; transition: all 0.2s ease; white-space: nowrap; }
        .btn:hover { background: #f9fafb; border-color: #d1d5db; }
        .btn.active { background: #0066ff; color: white; border-color: #0066ff; }
        body.dark-mode { background: #2d0818; }
        body.dark-mode .sidebar { background: #3a0a1f; border-color: #5a1a3a; }
        body.dark-mode .logo-icon { background: linear-gradient(135deg, #8b5a8a 0%, #a67aa6 100%); }
        body.dark-mode .logo-text { color: #c5d2f8; }
        body.dark-mode .nav-title { color: #9a8a9a; }
        body.dark-mode .nav-item { color: #b8a8b8; }
        body.dark-mode .nav-item:hover { background: #4f0c28; color: #c5d2f8; }
        body.dark-mode .nav-item.active { background: #6b2a4a; color: #c5d2f8; }
        body.dark-mode .top-bar { background: #3a0a1f; border-color: #5a1a3a; }
        body.dark-mode .card { background: #3a0a1f; border-color: #5a1a3a; }
        body.dark-mode .card-header { border-color: #5a1a3a; }
        body.dark-mode .card-title { color: #c5d2f8; }
        body.dark-mode .lesson-title { color: #c5d2f8; }
        body.dark-mode .lesson-meta { color: #b8a8b8; }
        body.dark-mode .latin-text { color: #c5d2f8; text-shadow: 0 0 20px rgba(197, 210, 248, 0.15); }
        body.dark-mode .word:hover { background: rgba(232, 212, 168, 0.25); }
        body.dark-mode .word.active { background: rgba(232, 212, 168, 0.35); }
        body.dark-mode .btn { background: #4f0c28; border-color: #6b2a4a; color: #c5d2f8; }
        body.dark-mode .btn:hover { background: #5a1a3a; }
        body.dark-mode .btn.active { background: #7a3a5a; border-color: #8a4a6a; }
        body.dark-mode .resource-card { background: #4f0c28; border-color: #5a1a3a; }
        body.dark-mode .resource-card h4 { color: #c5d2f8; }
        body.dark-mode .resource-card p, body.dark-mode .resource-card li { color: #b8c8e8; }
        body.dark-mode .vocab-popup { background: #4f0c28; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5); }
        body.dark-mode .vocab-popup::before { border-bottom-color: #4f0c28; }
        body.dark-mode .vocab-popup.arrow-bottom::before { border-bottom-color: transparent; border-top-color: #4f0c28; }
        body.dark-mode .vocab-popup h4 { color: #e8d4a8; }
        body.dark-mode .vocab-popup .parsing { color: #b8a8b8; }
        body.dark-mode .vocab-popup .meaning { color: #c5d2f8; }
        body.dark-mode .vocab-popup .principal-parts { color: #a8b8d8; border-color: #5a1a3a; }
        .latin-text p { padding: 0.5rem 0.75rem; margin: 0 -0.75rem 1.5rem -0.75rem; border-radius: 6px; transition: background 0.2s ease; }
        .latin-text p:hover { background: rgba(59, 130, 246, 0.08); }
        body.dark-mode .latin-text p:hover { background: rgba(197, 210, 248, 0.1); }
        .latin-text.sentence-mode p { display: none; }
        .latin-text.sentence-mode p.current-sentence { display: block; }
        .sentence-nav { display: none; align-items: center; justify-content: center; gap: 1rem; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e5e7eb; }
        .sentence-nav.visible { display: flex; }
        body.dark-mode .sentence-nav { border-color: #5a1a3a; }
        .sentence-nav button { padding: 0.5rem 1rem; border: 1px solid #e5e7eb; background: white; border-radius: 6px; font-size: 0.875rem; cursor: pointer; }
        .sentence-nav button:disabled { opacity: 0.4; cursor: not-allowed; }
        body.dark-mode .sentence-nav button { background: #4f0c28; border-color: #6b2a4a; color: #c5d2f8; }
        .sentence-counter { font-size: 0.875rem; color: #6b7280; min-width: 80px; text-align: center; }
        body.dark-mode .sentence-counter { color: #b8a8b8; }
        body.full-screen .sidebar { display: none; }
        body.full-screen .main-content { margin-left: 0; }
        body.full-screen .lesson-header { display: none; }
        body.full-screen .content-container { max-width: 100%; padding: 1rem 2rem; }
        body.full-screen .card { border: none; border-radius: 0; background: transparent; }
        body.full-screen .card-header { display: none; }
        body.full-screen .latin-text { font-size: 2rem; line-height: 2.6; }
        body.full-screen .btn-group { position: fixed; bottom: 1.5rem; right: 1.5rem; background: white; padding: 0.75rem; border-radius: 10px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); z-index: 200; }
        body.full-screen.dark-mode .btn-group { background: #3a0a1f; }
        body.full-screen .resource-card { display: none !important; }
        body.full-screen .top-bar { display: none; }
        .latin-text.show-lines p { display: flex; align-items: flex-start; }
        .line-number { display: none; min-width: 2.5rem; color: #9ca3af; font-size: 0.875rem; padding-top: 0.3rem; user-select: none; }
        .latin-text.show-lines .line-number { display: block; }
        body.dark-mode .line-number { color: #7a6a7a; }
        .line-content { flex: 1; }
        .word.pointed { background: rgba(255, 200, 50, 0.5) !important; box-shadow: 0 0 12px rgba(255, 200, 50, 0.6); }
        body.dark-mode .word.pointed { background: rgba(232, 212, 168, 0.5) !important; }
        body.pointer-mode .word { cursor: crosshair; }
        .mode-indicator { display: none; position: fixed; top: 1rem; right: 1rem; background: #fef3c7; color: #92400e; padding: 0.5rem 1rem; border-radius: 6px; font-size: 0.875rem; font-weight: 500; z-index: 200; }
        body.pointer-mode .mode-indicator { display: block; }
        body.dark-mode .mode-indicator { background: #4f0c28; color: #e8d4a8; }
        .resource-card { background: #f9fafb; border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem; border: 1px solid #e5e7eb; display: none; }
        .resource-card.active { display: block; }
        .resource-card h4 { font-size: 1rem; font-weight: 600; color: #1f2937; margin-bottom: 0.75rem; }
        .resource-card p, .resource-card li { font-size: 0.95rem; line-height: 1.8; color: #374151; }
        .resource-card ul { margin-left: 1.5rem; margin-top: 0.5rem; }
        @media (max-width: 768px) { .sidebar { transform: translateX(-100%); } .main-content { margin-left: 0; } .latin-text { font-size: 1.25rem; } }

        /* Three-tier stylistic analysis colors */
        .style-tier-1 { background: rgba(59, 130, 246, 0.2); border-radius: 3px; }
        .style-tier-1:hover { background: rgba(59, 130, 246, 0.35); }
        .style-tier-2 { background: rgba(249, 115, 22, 0.2); border-radius: 3px; }
        .style-tier-2:hover { background: rgba(249, 115, 22, 0.35); }
        .style-tier-3 { background: rgba(34, 197, 94, 0.2); border-radius: 3px; }
        .style-tier-3:hover { background: rgba(34, 197, 94, 0.35); }
        body.dark-mode .style-tier-1 { background: rgba(96, 165, 250, 0.25); }
        body.dark-mode .style-tier-1:hover { background: rgba(96, 165, 250, 0.4); }
        body.dark-mode .style-tier-2 { background: rgba(251, 146, 60, 0.25); }
        body.dark-mode .style-tier-2:hover { background: rgba(251, 146, 60, 0.4); }
        body.dark-mode .style-tier-3 { background: rgba(74, 222, 128, 0.25); }
        body.dark-mode .style-tier-3:hover { background: rgba(74, 222, 128, 0.4); }
        .latin-text:not(.style-mode) .style-tier-1,
        .latin-text:not(.style-mode) .style-tier-2,
        .latin-text:not(.style-mode) .style-tier-3 { background: transparent; }

        /* Style popup */
        .style-popup { position: fixed; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(0, 0, 0, 0.05); padding: 1.25rem 1.5rem; z-index: 1000; max-width: 420px; min-width: 300px; display: none; animation: popIn 0.2s ease; }
        .style-popup.visible { display: block; }
        .style-popup .style-badge { display: inline-block; padding: 0.25rem 0.625rem; border-radius: 4px; font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.75rem; }
        .style-popup .style-badge.tier-1 { background: rgba(59, 130, 246, 0.15); color: #2563eb; }
        .style-popup .style-badge.tier-2 { background: rgba(249, 115, 22, 0.15); color: #ea580c; }
        .style-popup .style-badge.tier-3 { background: rgba(34, 197, 94, 0.15); color: #16a34a; }
        .style-popup h4 { font-size: 1.1rem; font-weight: 600; color: #1f2937; margin-bottom: 0.5rem; font-style: italic; }
        .style-popup .device-name { font-size: 0.9rem; font-weight: 600; color: #0066ff; margin-bottom: 0.75rem; }
        .style-popup .effect { font-size: 0.9rem; line-height: 1.6; color: #4b5563; }
        body.dark-mode .style-popup { background: #4f0c28; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5); }
        body.dark-mode .style-popup h4 { color: #e8d4a8; }
        body.dark-mode .style-popup .device-name { color: #93c5fd; }
        body.dark-mode .style-popup .effect { color: #c5d2f8; }
        body.dark-mode .style-popup .style-badge.tier-1 { background: rgba(96, 165, 250, 0.2); color: #93c5fd; }
        body.dark-mode .style-popup .style-badge.tier-2 { background: rgba(251, 146, 60, 0.2); color: #fdba74; }
        body.dark-mode .style-popup .style-badge.tier-3 { background: rgba(74, 222, 128, 0.2); color: #86efac; }

        /* Style mode legend */
        .style-legend { display: none; background: #f9fafb; border-radius: 8px; padding: 1rem 1.25rem; margin-top: 1rem; border: 1px solid #e5e7eb; }
        .style-legend.visible { display: block; }
        .style-legend h5 { font-size: 0.8rem; font-weight: 600; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.75rem; }
        .style-legend-items { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .style-legend-item { display: flex; align-items: center; gap: 0.5rem; font-size: 0.8rem; color: #4b5563; }
        .style-legend-color { width: 14px; height: 14px; border-radius: 3px; }
        .style-legend-color.tier-1 { background: rgba(59, 130, 246, 0.4); }
        .style-legend-color.tier-2 { background: rgba(249, 115, 22, 0.4); }
        .style-legend-color.tier-3 { background: rgba(34, 197, 94, 0.4); }
        body.dark-mode .style-legend { background: #4f0c28; border-color: #5a1a3a; }
        body.dark-mode .style-legend h5 { color: #b8a8b8; }
        body.dark-mode .style-legend-item { color: #c5d2f8; }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="logo-section">
            <a href="../../../index.html" class="logo">
                <div class="logo-icon">C</div>
                <span class="logo-text">Classicalia</span>
            </a>
        </div>
        <nav class="nav-section">
            <div class="nav-title">Resources</div>
            <div class="nav-item active" onclick="showView('text')"><span class="nav-icon">üìñ</span><span>Read</span></div>
            <div class="nav-item" onclick="showView('summary')"><span class="nav-icon">üìã</span><span>Summary</span></div>
            <div class="nav-item" onclick="showView('context')"><span class="nav-icon">üèõÔ∏è</span><span>Context</span></div>
            <div class="nav-item" onclick="showView('comprehension')"><span class="nav-icon">‚ùì</span><span>Comprehension</span></div>
        </nav>
        <nav class="nav-section">
            <div class="nav-title">Sections</div>
            <a href="section1.html" class="nav-item">Section 1 (14.1)</a>
            <a href="section2.html" class="nav-item">Section 2 (14.2)</a>
            <a href="section3.html" class="nav-item">Section 3 (14.3)</a>
            <a href="section4.html" class="nav-item">Section 4 (14.4)</a>
            <a href="section5.html" class="nav-item">Section 5 (14.5)</a>
            <a href="section6.html" class="nav-item">Section 6 (14.6)</a>
            <a href="section7.html" class="nav-item active">Section 7 (14.7)</a>
            <a href="section8.html" class="nav-item">Section 8 (14.8)</a>
        </nav>
    </aside>

    <main class="main-content">
        <div class="top-bar"></div>
        <div class="content-wrapper">
            <div class="content-container">
                <header class="lesson-header">
                    <h1 class="lesson-title">Nero's Panic and Final Plot</h1>
                    <div class="lesson-meta">
                        <span>üìï Tacitus Annals 14.7</span>
                        <span>‚è±Ô∏è 60 min</span>
                        <span>üìä A-Level</span>
                    </div>
                </header>

                <div class="card" id="textCard">
                    <div class="card-header"><h3 class="card-title">Latin Text</h3></div>
                    <div class="card-body">
                        <div class="latin-text" id="latinText"></div>
                        <div class="style-legend" id="styleLegend">
                            <h5>Style Colour Key</h5>
                            <div class="style-legend-items">
                                <div class="style-legend-item"><div class="style-legend-color tier-1"></div>Sound & Rhetoric</div>
                                <div class="style-legend-item"><div class="style-legend-color tier-2"></div>Dramatic Technique</div>
                                <div class="style-legend-item"><div class="style-legend-color tier-3"></div>Structure & Word Order</div>
                            </div>
                        </div>
                        <div class="btn-group">
                            <button class="btn" onclick="toggleTranslation()">Translation</button>
                            <button class="btn" onclick="toggleSentenceMode()">Sentence Mode</button>
                            <button class="btn" onclick="toggleLineNumbers()">Line Numbers</button>
                            <button class="btn" onclick="toggleStyleMode()">Style</button>
                            <button class="btn" onclick="togglePointerMode()">Pointer Mode</button>
                            <button class="btn" onclick="toggleDarkMode()">üåô Dark</button>
                            <button class="btn" onclick="toggleFullScreen()">‚õ∂ Full Screen</button>
                        </div>
                        <div class="sentence-nav" id="sentenceNav">
                            <button onclick="prevSentence()">‚Üê Previous</button>
                            <span class="sentence-counter" id="sentenceCounter">1 / 10</span>
                            <button onclick="nextSentence()">Next ‚Üí</button>
                        </div>
                        <div class="resource-card" id="translationBox">
                            <h4>Translation</h4>
                            <p>Meanwhile, it was reported to Nero, who was waiting for news of the accomplishment of the crime, that Agrippina had escaped, though wounded by a light blow and having encountered danger to such an extent that the instigator was undoubted. Then, petrified with fear and protesting that she would be there at any moment now, eager for revenge, whether she was arming slaves or inflaming the soldiery or making her way to the Senate and the people, charging him with the shipwreck, the wound and her slaughtered friends: what help did he have against her? Apart from anything Burrus and Seneca might be able to do; waking them up, he had summoned them immediately, though it was uncertain whether they were aware of the situation previously. And so, both were silent for a long time, lest they might try to dissuade him without effect, or they believed that the situation had deteriorated to the point where Nero would have to die unless Agrippina was forestalled. Next Seneca acted more readily up to this extent that he looked back at Burrus and enquired whether the soldiery should be ordered to murder her. He replied that the praetorians were bound by oath to the whole house of the Caesars, and, remembering Germanicus, would not dare to do anything violent against his offspring: Anicetus should fulfil his promises. He, without any delay, demanded complete control of the crime. At that utterance, Nero acknowledged that supreme power was being given to himself on that day and that a freedman was the instigator of such a great gift. He should go quickly and take those who were most ready to do his orders. He himself, when he heard that Agerinus had come as a messenger sent by Agrippina, of his own accord prepared a 'crime scene' and threw a sword between his feet while Agerinus was carrying out his instructions, then ordered chains to be cast upon him, as if he had been caught red-handed, so that he might pretend that his mother had attempted the destruction of the emperor and had chosen death voluntarily in her shame that the crime had been detected.</p>
                        </div>
                    </div>
                </div>

                <div class="card" id="resourceCard" style="display: none; margin-top: 1.5rem;">
                    <div class="card-header"><h3 class="card-title" id="resourceTitle">Summary</h3></div>
                    <div class="card-body" id="resourceContent"></div>
                </div>
            </div>
        </div>
    </main>

    <div class="vocab-popup" id="vocabPopup"></div>
    <div class="style-popup" id="stylePopup"></div>
    <div class="mode-indicator">üìç Pointer Mode</div>

    <script>
const vocab = {
    "at": { lemma: "at", parsing: "conjunction", meaning: "but, meanwhile" },
    "neroni": { lemma: "Nero, -onis (m.)", parsing: "dat. sing.", meaning: "to Nero" },
    "nuntios": { lemma: "nuntius, -i (m.)", parsing: "acc. pl.", meaning: "messages, news" },
    "patrati": { lemma: "patro, -are, -avi, -atum", parsing: "perf. pass. part. gen.", meaning: "of accomplished" },
    "facinoris": { lemma: "facinus, -oris (n.)", parsing: "gen. sing.", meaning: "crime, deed" },
    "opperienti": { lemma: "opperior, -iri, oppertus sum", parsing: "pres. part. dat.", meaning: "waiting for" },
    "adfertur": { lemma: "adfero, adferre, attuli, allatum", parsing: "pres. pass. ind. 3rd sing.", meaning: "it is reported" },
    "evasisse": { lemma: "evado, -ere, evasi, evasum", parsing: "perf. inf. act.", meaning: "to have escaped" },
    "ictu": { lemma: "ictus, -us (m.)", parsing: "abl. sing.", meaning: "by a blow" },
    "levi": { lemma: "levis, -e", parsing: "abl. sing.", meaning: "light" },
    "sauciam": { lemma: "saucius, -a, -um", parsing: "acc. fem. sing.", meaning: "wounded" },
    "et": { lemma: "et", parsing: "conjunction", meaning: "and" },
    "hactenus": { lemma: "hactenus", parsing: "adverb", meaning: "to such an extent, so far" },
    "adito": { lemma: "adeo, adire, adii, aditum", parsing: "perf. pass. part. abl.", meaning: "approached" },
    "discrimine": { lemma: "discrimen, -inis (n.)", parsing: "abl. sing.", meaning: "danger" },
    "ne": { lemma: "ne", parsing: "conjunction", meaning: "that...not, lest" },
    "auctor": { lemma: "auctor, -oris (m.)", parsing: "nom. sing.", meaning: "author, instigator" },
    "dubitaretur": { lemma: "dubito, -are, -avi, -atum", parsing: "imperf. subj. pass. 3rd sing.", meaning: "might be doubted" },
    "tum": { lemma: "tum", parsing: "adverb", meaning: "then" },
    "pavore": { lemma: "pavor, -oris (m.)", parsing: "abl. sing.", meaning: "with panic" },
    "exanimis": { lemma: "exanimis, -e", parsing: "nom. sing.", meaning: "lifeless, terrified" },
    "iam": { lemma: "iam", parsing: "adverb", meaning: "now, already" },
    "iamque": { lemma: "iam + -que", parsing: "adverb", meaning: "and now" },
    "adfore": { lemma: "adsum, adesse, adfui", parsing: "fut. inf.", meaning: "would be present" },
    "obtestans": { lemma: "obtestor, -ari, -atus sum", parsing: "pres. part. nom.", meaning: "protesting" },
    "vindictae": { lemma: "vindicta, -ae (f.)", parsing: "dat. sing.", meaning: "for revenge" },
    "properam": { lemma: "properus, -a, -um", parsing: "acc. fem. sing.", meaning: "swift, eager" },
    "sive": { lemma: "sive", parsing: "conjunction", meaning: "whether, or if" },
    "servitia": { lemma: "servitium, -i (n.)", parsing: "acc. pl.", meaning: "slaves" },
    "armaret": { lemma: "armo, -are, -avi, -atum", parsing: "imperf. subj. act. 3rd sing.", meaning: "she might arm" },
    "vel": { lemma: "vel", parsing: "conjunction", meaning: "or" },
    "militem": { lemma: "miles, militis (m.)", parsing: "acc. sing.", meaning: "soldiers" },
    "accenderet": { lemma: "accendo, -ere, -i, -sum", parsing: "imperf. subj. act. 3rd sing.", meaning: "she might inflame" },
    "ad": { lemma: "ad", parsing: "preposition + acc.", meaning: "to, towards" },
    "senatum": { lemma: "senatus, -us (m.)", parsing: "acc. sing.", meaning: "Senate" },
    "populum": { lemma: "populus, -i (m.)", parsing: "acc. sing.", meaning: "people" },
    "pervaderet": { lemma: "pervado, -ere, -vasi, -vasum", parsing: "imperf. subj. act. 3rd sing.", meaning: "she might make her way" },
    "naufragium": { lemma: "naufragium, -i (n.)", parsing: "acc. sing.", meaning: "shipwreck" },
    "vulnus": { lemma: "vulnus, -eris (n.)", parsing: "acc. sing.", meaning: "wound" },
    "interfectos": { lemma: "interficio, -ere, -feci, -fectum", parsing: "perf. pass. part. acc. pl.", meaning: "murdered" },
    "amicos": { lemma: "amicus, -i (m.)", parsing: "acc. pl.", meaning: "friends" },
    "obiciendo": { lemma: "obicio, -ere, -ieci, -iectum", parsing: "gerund abl.", meaning: "by charging" },
    "quod": { lemma: "quod", parsing: "pronoun", meaning: "what" },
    "contra": { lemma: "contra", parsing: "preposition + acc.", meaning: "against" },
    "subsidium": { lemma: "subsidium, -i (n.)", parsing: "nom. sing.", meaning: "help, support" },
    "sibi": { lemma: "sui, sibi, se", parsing: "dat. reflexive", meaning: "for himself" },
    "nisi": { lemma: "nisi", parsing: "conjunction", meaning: "unless, except" },
    "quid": { lemma: "quid", parsing: "indefinite pronoun", meaning: "anything" },
    "burrus": { lemma: "Burrus, -i (m.)", parsing: "nom. sing.", meaning: "Burrus" },
    "seneca": { lemma: "Seneca, -ae (m.)", parsing: "nom. sing.", meaning: "Seneca" },
    "quos": { lemma: "qui, quae, quod", parsing: "rel. pron. acc. pl.", meaning: "whom" },
    "expergens": { lemma: "expergo, -ere, experrexi", parsing: "pres. part. nom.", meaning: "waking up" },
    "statim": { lemma: "statim", parsing: "adverb", meaning: "immediately" },
    "acciverat": { lemma: "accio, -ire, -ivi, -itum", parsing: "pluperf. act. ind. 3rd sing.", meaning: "he had summoned" },
    "incertum": { lemma: "incertus, -a, -um", parsing: "nom. neut. sing.", meaning: "uncertain" },
    "an": { lemma: "an", parsing: "conjunction", meaning: "whether" },
    "ante": { lemma: "ante", parsing: "adverb", meaning: "before, previously" },
    "gnaros": { lemma: "gnarus, -a, -um", parsing: "acc. pl.", meaning: "aware, knowing" },
    "igitur": { lemma: "igitur", parsing: "conjunction", meaning: "therefore" },
    "longum": { lemma: "longus, -a, -um", parsing: "acc. neut. sing.", meaning: "long" },
    "utriusque": { lemma: "uterque, utraque, utrumque", parsing: "gen. sing.", meaning: "of both" },
    "silentium": { lemma: "silentium, -i (n.)", parsing: "nom. sing.", meaning: "silence" },
    "inriti": { lemma: "inritus, -a, -um", parsing: "nom. pl.", meaning: "in vain, without effect" },
    "dissuaderent": { lemma: "dissuadeo, -ere, -suasi, -suasum", parsing: "imperf. subj. act. 3rd pl.", meaning: "they might dissuade" },
    "eo": { lemma: "eo", parsing: "adverb", meaning: "to that point" },
    "descensum": { lemma: "descendo, -ere, -i, -sum", parsing: "perf. pass. part. acc.", meaning: "descended" },
    "credebant": { lemma: "credo, -ere, credidi, creditum", parsing: "imperf. act. ind. 3rd pl.", meaning: "they believed" },
    "ut": { lemma: "ut", parsing: "conjunction", meaning: "that, so that" },
    "praeveniretur": { lemma: "praevenio, -ire, -veni, -ventum", parsing: "imperf. subj. pass. 3rd sing.", meaning: "she might be forestalled" },
    "agrippina": { lemma: "Agrippina, -ae (f.)", parsing: "nom. sing.", meaning: "Agrippina" },
    "pereundum": { lemma: "pereo, perire, perii, peritum", parsing: "gerundive neut.", meaning: "must die" },
    "esset": { lemma: "sum, esse, fui", parsing: "imperf. subj. 3rd sing.", meaning: "would be" },
    "post": { lemma: "post", parsing: "adverb", meaning: "afterwards" },
    "promptius": { lemma: "prompte", parsing: "comparative adverb", meaning: "more readily" },
    "respiceret": { lemma: "respicio, -ere, -spexi, -spectum", parsing: "imperf. subj. act. 3rd sing.", meaning: "he looked back" },
    "burrum": { lemma: "Burrus, -i (m.)", parsing: "acc. sing.", meaning: "at Burrus" },
    "ac": { lemma: "ac", parsing: "conjunction", meaning: "and" },
    "sciscitaretur": { lemma: "sciscitor, -ari, -atus sum", parsing: "imperf. subj. 3rd sing.", meaning: "he enquired" },
    "militi": { lemma: "miles, militis (m.)", parsing: "dat. sing.", meaning: "to soldiers" },
    "imperanda": { lemma: "impero, -are, -avi, -atum", parsing: "gerundive fem.", meaning: "to be ordered" },
    "caedes": { lemma: "caedes, -is (f.)", parsing: "nom. sing.", meaning: "murder, slaughter" },
    "ille": { lemma: "ille, illa, illud", parsing: "nom. masc. sing.", meaning: "he, that one" },
    "praetorianos": { lemma: "praetorianus, -i (m.)", parsing: "acc. pl.", meaning: "praetorians" },
    "toti": { lemma: "totus, -a, -um", parsing: "dat. sing.", meaning: "to whole" },
    "caesarum": { lemma: "Caesar, -aris (m.)", parsing: "gen. pl.", meaning: "of the Caesars" },
    "domui": { lemma: "domus, -us (f.)", parsing: "dat. sing.", meaning: "house" },
    "obstrictos": { lemma: "obstringo, -ere, -strinxi, -strictum", parsing: "perf. pass. part. acc. pl.", meaning: "bound" },
    "memores": { lemma: "memor, -oris", parsing: "acc. pl.", meaning: "remembering" },
    "germanici": { lemma: "Germanicus, -i (m.)", parsing: "gen. sing.", meaning: "of Germanicus" },
    "nihil": { lemma: "nihil", parsing: "indeclinable", meaning: "nothing" },
    "adversus": { lemma: "adversus", parsing: "preposition + acc.", meaning: "against" },
    "progeniem": { lemma: "progenies, -ei (f.)", parsing: "acc. sing.", meaning: "offspring" },
    "eius": { lemma: "is, ea, id", parsing: "gen. sing.", meaning: "his" },
    "atrox": { lemma: "atrox, -ocis", parsing: "acc. neut.", meaning: "cruel, terrible" },
    "ausuros": { lemma: "audeo, -ere, ausus sum", parsing: "fut. part. acc. pl.", meaning: "would dare" },
    "respondit": { lemma: "respondeo, -ere, -di, -sum", parsing: "perf. act. ind. 3rd sing.", meaning: "replied" },
    "perpetraret": { lemma: "perpetro, -are, -avi, -atum", parsing: "imperf. subj. act. 3rd sing.", meaning: "should complete" },
    "anicetus": { lemma: "Anicetus, -i (m.)", parsing: "nom. sing.", meaning: "Anicetus" },
    "promissa": { lemma: "promissum, -i (n.)", parsing: "acc. pl.", meaning: "promises" },
    "qui": { lemma: "qui, quae, quod", parsing: "rel. pron. nom.", meaning: "who" },
    "cunctatus": { lemma: "cunctor, -ari, -atus sum", parsing: "perf. part. nom.", meaning: "having delayed" },
    "poscit": { lemma: "posco, -ere, poposci", parsing: "pres. act. ind. 3rd sing.", meaning: "demands" },
    "summam": { lemma: "summa, -ae (f.)", parsing: "acc. sing.", meaning: "complete control" },
    "sceleris": { lemma: "scelus, -eris (n.)", parsing: "gen. sing.", meaning: "of crime" },
    "eam": { lemma: "is, ea, id", parsing: "acc. fem. sing.", meaning: "that" },
    "vocem": { lemma: "vox, vocis (f.)", parsing: "acc. sing.", meaning: "utterance" },
    "nero": { lemma: "Nero, -onis (m.)", parsing: "nom. sing.", meaning: "Nero" },
    "illo": { lemma: "ille, illa, illud", parsing: "abl. sing.", meaning: "on that" },
    "die": { lemma: "dies, diei (m.)", parsing: "abl. sing.", meaning: "day" },
    "dari": { lemma: "do, dare, dedi, datum", parsing: "pres. pass. inf.", meaning: "to be given" },
    "imperium": { lemma: "imperium, -i (n.)", parsing: "acc. sing.", meaning: "supreme power" },
    "auctorem": { lemma: "auctor, -oris (m.)", parsing: "acc. sing.", meaning: "author, source" },
    "tanti": { lemma: "tantus, -a, -um", parsing: "gen. sing.", meaning: "of such great" },
    "muneris": { lemma: "munus, -eris (n.)", parsing: "gen. sing.", meaning: "gift" },
    "libertum": { lemma: "libertus, -i (m.)", parsing: "acc. sing.", meaning: "freedman" },
    "profitetur": { lemma: "profiteor, -eri, professus sum", parsing: "pres. dep. ind. 3rd sing.", meaning: "declares" },
    "iret": { lemma: "eo, ire, ivi/ii, itum", parsing: "imperf. subj. act. 3rd sing.", meaning: "he should go" },
    "propere": { lemma: "propere", parsing: "adverb", meaning: "quickly" },
    "duceret": { lemma: "duco, -ere, duxi, ductum", parsing: "imperf. subj. act. 3rd sing.", meaning: "he should lead" },
    "promptissimos": { lemma: "promptus, -a, -um", parsing: "superlative acc. pl.", meaning: "most ready" },
    "iussa": { lemma: "iussum, -i (n.)", parsing: "acc. pl.", meaning: "orders" },
    "ipse": { lemma: "ipse, ipsa, ipsum", parsing: "nom. masc. sing.", meaning: "he himself" },
    "audito": { lemma: "audio, -ire, -ivi, -itum", parsing: "perf. pass. part. abl.", meaning: "having heard" },
    "venisse": { lemma: "venio, -ire, veni, ventum", parsing: "perf. inf. act.", meaning: "to have come" },
    "missu": { lemma: "missus, -us (m.)", parsing: "abl. sing.", meaning: "by sending" },
    "agrippinae": { lemma: "Agrippina, -ae (f.)", parsing: "gen. sing.", meaning: "of Agrippina" },
    "nuntium": { lemma: "nuntius, -i (m.)", parsing: "acc. sing.", meaning: "as messenger" },
    "agerinum": { lemma: "Agerinus, -i (m.)", parsing: "acc. sing.", meaning: "Agerinus" },
    "scaenam": { lemma: "scaena, -ae (f.)", parsing: "acc. sing.", meaning: "scene" },
    "ultro": { lemma: "ultro", parsing: "adverb", meaning: "of his own accord" },
    "criminis": { lemma: "crimen, -inis (n.)", parsing: "gen. sing.", meaning: "of crime" },
    "parat": { lemma: "paro, -are, -avi, -atum", parsing: "pres. act. ind. 3rd sing.", meaning: "prepares" },
    "gladium": { lemma: "gladius, -i (m.)", parsing: "acc. sing.", meaning: "sword" },
    "dum": { lemma: "dum", parsing: "conjunction", meaning: "while" },
    "mandata": { lemma: "mandatum, -i (n.)", parsing: "acc. pl.", meaning: "instructions" },
    "perfert": { lemma: "perfero, -ferre, -tuli, -latum", parsing: "pres. act. ind. 3rd sing.", meaning: "carries out" },
    "abicit": { lemma: "abicio, -ere, -ieci, -iectum", parsing: "pres. act. ind. 3rd sing.", meaning: "throws down" },
    "inter": { lemma: "inter", parsing: "preposition + acc.", meaning: "between" },
    "pedes": { lemma: "pes, pedis (m.)", parsing: "acc. pl.", meaning: "feet" },
    "quasi": { lemma: "quasi", parsing: "conjunction", meaning: "as if" },
    "deprehenso": { lemma: "deprehendo, -ere, -i, -sum", parsing: "perf. pass. part. abl.", meaning: "caught" },
    "vincla": { lemma: "vinculum, -i (n.)", parsing: "acc. pl.", meaning: "chains" },
    "inici": { lemma: "inicio, -ere, -ieci, -iectum", parsing: "pres. pass. inf.", meaning: "to be thrown on" },
    "iubet": { lemma: "iubeo, -ere, iussi, iussum", parsing: "pres. act. ind. 3rd sing.", meaning: "orders" },
    "exitium": { lemma: "exitium, -i (n.)", parsing: "acc. sing.", meaning: "destruction" },
    "principis": { lemma: "princeps, -cipis (m.)", parsing: "gen. sing.", meaning: "of the emperor" },
    "molitam": { lemma: "molior, -iri, molitus sum", parsing: "perf. part. acc. fem.", meaning: "having attempted" },
    "matrem": { lemma: "mater, matris (f.)", parsing: "acc. sing.", meaning: "mother" },
    "pudore": { lemma: "pudor, -oris (m.)", parsing: "abl. sing.", meaning: "through shame" },
    "deprehensi": { lemma: "deprehendo, -ere, -i, -sum", parsing: "perf. pass. part. gen.", meaning: "of detected" },
    "sponte": { lemma: "spons, spontis (f.)", parsing: "abl. sing.", meaning: "voluntarily" },
    "mortem": { lemma: "mors, mortis (f.)", parsing: "acc. sing.", meaning: "death" },
    "sumpsisse": { lemma: "sumo, -ere, sumpsi, sumptum", parsing: "perf. inf. act.", meaning: "to have taken" },
    "confingeret": { lemma: "confingo, -ere, -finxi, -fictum", parsing: "imperf. subj. act. 3rd sing.", meaning: "he might fabricate" }
};

// Three-tier stylistic analysis data
// Tier 1 (Blue): Sound & Rhetoric - alliteration, repetition, tricolon, polysyndeton
// Tier 2 (Orange): Dramatic Technique - irony, metaphor, characterization, pathos
// Tier 3 (Green): Structure & Word Order - hyperbaton, climax, antithesis, framing
const styleData = {
    "pavore_exanimis": {
        tier: 2,
        latin: "pavore exanimis",
        device: "Hyperbole / Metaphor",
        effect: "Literally 'lifeless with fear' - Tacitus uses hyperbolic language to expose Nero's cowardice. The man who ordered his mother's murder now trembles at news of her survival. The metaphor of being 'breathless' or 'soulless' (exanimis) strips Nero of his imperial dignity, reducing him to a quivering wreck. The ablative of cause (pavore) emphasises that raw terror has drained the life from him."
    },
    "iam_iamque": {
        tier: 1,
        latin: "iam iamque",
        device: "Geminatio (Repetition)",
        effect: "The doubling of 'iam' creates urgent, panicked rhythm reflecting Nero's frantic state of mind. 'Now and now' suggests his terrified imagination keeps returning obsessively to the same fear: Agrippina's imminent arrival. This rhetorical device mimics the racing, repetitive thoughts of someone in panic, making Nero's psychological state vivid to the reader."
    },
    "sive_vel_ad": {
        tier: 3,
        latin: "sive servitia armaret vel militem accenderet, ad senatum et populum pervaderet",
        device: "Tricolon with Climax",
        effect: "Three escalating threats form a rising tricolon: arming slaves, inflaming soldiers, appealing to Senate and people. The structure moves from domestic (servitia) to military (militem) to constitutional (senatum et populum), representing ever-widening circles of danger. The climax reveals Nero's deepest fear: not physical violence but political exposure before Rome's institutions."
    },
    "naufragium_et_vulnus": {
        tier: 1,
        latin: "naufragium et vulnus et interfectos amicos",
        device: "Polysyndeton / Tricolon",
        effect: "The repeated 'et...et...' (polysyndeton) gives weight to each accusation Agrippina could level. Three pieces of damning evidence form another tricolon: shipwreck, wound, dead friends. The piling up of conjunctions creates a drumbeat of incrimination. Tacitus shows us exactly what Nero fears being exposed: a catalogue of crimes that would damn him before the Roman public."
    },
    "longum_silentium": {
        tier: 2,
        latin: "longum utriusque silentium",
        device: "Dramatic Pause / Pregnant Silence",
        effect: "The 'long silence of both' creates a pregnant dramatic pause. Burrus and Seneca, Nero's advisors and supposedly Rome's moral guardians, say nothing. Their silence speaks volumes: they cannot bring themselves to condemn matricide but cannot endorse it either. Tacitus masterfully uses this silence to implicate the Stoic philosopher and the Praetorian Prefect in the coming murder through their complicity of inaction."
    },
    "pereundum_neroni": {
        tier: 3,
        latin: "pereundum Neroni esset",
        device: "Gerundive of Necessity / Antithesis",
        effect: "The impersonal gerundive creates stark necessity: 'there would have to be dying for Nero'. The passive construction (pereundum) euphemistically distances the advisors from directly stating 'Nero must die'. This grammatical structure also creates a brutal antithesis: either Agrippina dies or Nero does. The Latin forces the reader to see murder as the only option through the very grammar itself."
    },
    "memoresque_germanici": {
        tier: 2,
        latin: "memoresque Germanici",
        device: "Historical Pathos / Irony",
        effect: "Burrus invokes the memory of Germanicus, Agrippina's father and Rome's beloved hero. The soldiers 'remembering Germanicus' would refuse to harm his daughter. This creates bitter irony: the grandson of Germanicus (Nero) is plotting to murder his granddaughter. The appeal to family loyalty and pietas highlights the perversion of all natural bonds in this scene of planned matricide."
    },
    "summam_sceleris": {
        tier: 2,
        latin: "summam sceleris",
        device: "Euphemism / Dramatic Irony",
        effect: "Anicetus demands 'complete control of the crime' - a chillingly businesslike euphemism. 'Summa' typically means 'total' or 'sum' in financial contexts; here it reduces matricide to a transaction. The phrase also contains irony: Anicetus eagerly claims the 'summa' of evil as if it were a prize. Tacitus's clinical vocabulary exposes the banality of evil at the imperial court."
    },
    "illo_die_imperium": {
        tier: 2,
        latin: "illo die sibi dari imperium",
        device: "Dramatic Irony / Perverse Logic",
        effect: "Nero declares that 'on that day supreme power is being given to him' - a grotesque claim that murdering his mother represents the true beginning of his reign. The dramatic irony is bitter: Nero equates freedom from maternal influence with legitimate power. This perverted logic reveals how Nero has conflated personal liberation from Agrippina with political sovereignty, exposing his psychological dependence even as he orders her death."
    },
    "scaenam_criminis": {
        tier: 2,
        latin: "scaenam ultro criminis parat",
        device: "Theatrical Metaphor",
        effect: "Nero 'prepares a scene (scaenam) of crime' - the theatrical metaphor is devastating. 'Scaena' evokes the stage, and Nero, famous for his acting ambitions, now stages a real-life drama of fabricated assassination. 'Ultro' (of his own accord) emphasises that this theatrical fiction is Nero's own initiative. Tacitus transforms the emperor into a playwright of his own crimes, directing a performance where truth becomes whatever he scripts."
    },
    "confingeret": {
        tier: 3,
        latin: "confingeret",
        device: "Word Choice / Framing",
        effect: "The final word 'confingeret' (he might fabricate/invent) is placed emphatically at the sentence's end. This verb of fiction-making frames Nero's entire narrative as a lie from its very last word. The subjunctive mood shows purpose: all the preceding actions (planting the sword, arresting Agerinus) exist solely so Nero 'might fabricate' this false story. Tacitus ensures that readers understand everything as calculated theatrical deception."
    }
};

const latinSentences = [
    "at Neroni nuntios patrati facinoris opperienti adfertur evasisse ictu levi sauciam et hactenus adito discrimine ne auctor dubitaretur.",
    "tum pavore exanimis et iam iamque adfore obtestans vindictae properam,",
    "sive servitia armaret vel militem accenderet, ad senatum et populum pervaderet, naufragium et vulnus et interfectos amicos obiciendo:",
    "quod contra subsidium sibi? nisi quid Burrus et Seneca; quos expergens statim acciverat, incertum an et ante gnaros.",
    "igitur longum utriusque silentium, ne inriti dissuaderent, an eo descensum credebant ut, nisi praeveniretur Agrippina, pereundum Neroni esset.",
    "post Seneca hactenus promptius ut respiceret Burrum ac sciscitaretur an militi imperanda caedes esset.",
    "ille praetorianos toti Caesarum domui obstrictos memoresque Germanici nihil adversus progeniem eius atrox ausuros respondit: perpetraret Anicetus promissa.",
    "qui nihil cunctatus poscit summam sceleris.",
    "eam vocem Nero illo die sibi dari imperium auctorem tanti muneris libertum profitetur: iret propere duceretque promptissimos ad iussa.",
    "ipse audito venisse missu Agrippinae nuntium Agerinum, scaenam ultro criminis parat, gladiumque dum mandata perfert abicit inter pedes, quasi deprehenso vincla inici iubet, ut exitium principis molitam matrem et pudore deprehensi sceleris sponte mortem sumpsisse confingeret."
];

const resources = {
    summary: `<h4>Summary</h4>
<p>Nero receives the catastrophic news: Agrippina lives, wounded but alive, and certainly knows who tried to kill her. Panic overwhelms him - he imagines her arming slaves, rousing the army, appealing to Senate and people with evidence of the shipwreck, her wound, and dead friends.</p>
<p>In desperation, he wakes Burrus and Seneca (Tacitus carefully notes uncertainty about their prior knowledge). Their long silence speaks volumes - whether from futility of dissuasion or recognition that it's kill or be killed. Seneca breaks silence, asking Burrus if the Praetorian Guard will execute Agrippina. Burrus refuses: the Guard are loyal to all Caesars and remember Germanicus too fondly to kill his daughter.</p>
<p>Anicetus eagerly volunteers to finish the job. Nero's relief is palpable - he declares this the day he truly receives empire, grotesquely crediting a freedman. When Agerinus arrives with Agrippina's message, Nero stages a false assassination attempt: dropping a sword at the messenger's feet, having him arrested as if caught attempting regicide. The fabricated story: Agrippina sent an assassin, then killed herself in shame when the plot failed.</p>`,
    context: `<h4>Historical Context</h4>
<p><strong>The Praetorian Guard:</strong> The Praetorian Guard's loyalty to Germanicus reflects historical reality - he was beloved by the military, and his children (including Agrippina) inherited that devotion. The Guard's oath was to the imperial family collectively, not just the current emperor.</p>
<p><strong>Burrus's Position:</strong> Burrus, as Praetorian Prefect, knew his men wouldn't obey an order to kill Germanicus's daughter. His refusal forces Nero to rely on Anicetus and the fleet, not the elite guard.</p>
<p><strong>Staged Evidence:</strong> The staging of false evidence was a Roman political tradition - planted weapons "proved" assassination attempts. The speed of events suggests everything happened within hours.</p>
<p><strong>Freedmen in Imperial Politics:</strong> Freedmen like Anicetus often did emperors' dirty work, being both dependent on imperial favour and expendable if caught. Nero's acknowledgment that a freedman was giving him "empire" is deeply ironic.</p>`,
    comprehension: `<h4>Comprehension Questions</h4>
<p><strong>Opening:</strong> How does "at Neroni nuntios patrati facinoris opperienti" immediately establish dramatic irony? What was Nero expecting?</p>
<p><strong>Nero's Panic:</strong> Analyse the phrase "pavore exanimis." What does Tacitus's choice of vocabulary suggest about Nero's character?</p>
<p><strong>The Tricolon:</strong> Examine "sive servitia armaret vel militem accenderet, ad senatum et populum pervaderet." What escalating threats does Nero imagine?</p>
<p><strong>The Silence:</strong> What is the significance of "longum utriusque silentium"? What does Tacitus suggest about Burrus and Seneca's complicity?</p>
<p><strong>Burrus's Refusal:</strong> Why does Burrus specifically mention Germanicus? What does this reveal about the limits of imperial power?</p>
<p><strong>Nero's Declaration:</strong> Analyse "illo die sibi dari imperium." What does this reveal about how Nero views his relationship with his mother?</p>
<p><strong>The Staged Scene:</strong> How does the planting of the sword and arrest of Agerinus function as theatrical performance? What does "scaenam criminis" suggest?</p>`
};

let sentenceModeActive = false, currentSentenceIndex = 0, pointerModeActive = false, styleModeActive = false;

function toggleDarkMode() { document.body.classList.toggle('dark-mode'); const isDark = document.body.classList.contains('dark-mode'); localStorage.setItem('darkMode', isDark); event.currentTarget.textContent = isDark ? '‚òÄÔ∏è Light' : 'üåô Dark'; event.currentTarget.classList.toggle('active', isDark); }
function toggleFullScreen() { document.body.classList.toggle('full-screen'); const isFS = document.body.classList.contains('full-screen'); event.currentTarget.textContent = isFS ? '‚õ∂ Exit Full Screen' : '‚õ∂ Full Screen'; event.currentTarget.classList.toggle('active', isFS); }
function toggleLineNumbers() { document.getElementById('latinText').classList.toggle('show-lines'); localStorage.setItem('lineNumbers', document.getElementById('latinText').classList.contains('show-lines')); event.currentTarget.classList.toggle('active'); }
function togglePointerMode() { pointerModeActive = !pointerModeActive; document.body.classList.toggle('pointer-mode'); event.currentTarget.classList.toggle('active'); if (!pointerModeActive) document.querySelectorAll('.word.pointed').forEach(w => w.classList.remove('pointed')); if (pointerModeActive) hidePopup(); }
function toggleSentenceMode() { const lt = document.getElementById('latinText'), sn = document.getElementById('sentenceNav'), btn = event.currentTarget; sentenceModeActive = !sentenceModeActive; if (sentenceModeActive) { lt.classList.add('sentence-mode'); sn.classList.add('visible'); btn.classList.add('active'); btn.textContent = 'Full Text'; currentSentenceIndex = 0; updateSentenceDisplay(); } else { lt.classList.remove('sentence-mode'); sn.classList.remove('visible'); btn.classList.remove('active'); btn.textContent = 'Sentence Mode'; document.querySelectorAll('.latin-text p').forEach(p => p.classList.remove('current-sentence')); } }
function updateSentenceDisplay() { const ps = document.querySelectorAll('.latin-text p'); ps.forEach((p, i) => p.classList.toggle('current-sentence', i === currentSentenceIndex)); document.getElementById('sentenceCounter').textContent = `${currentSentenceIndex + 1} / ${ps.length}`; const btns = document.querySelectorAll('.sentence-nav button'); btns[0].disabled = currentSentenceIndex === 0; btns[1].disabled = currentSentenceIndex === ps.length - 1; }
function prevSentence() { if (currentSentenceIndex > 0) { currentSentenceIndex--; updateSentenceDisplay(); hidePopup(); hideStylePopup(); } }
function nextSentence() { const p = document.querySelectorAll('.latin-text p'); if (currentSentenceIndex < p.length - 1) { currentSentenceIndex++; updateSentenceDisplay(); hidePopup(); hideStylePopup(); } }

function toggleStyleMode() {
    styleModeActive = !styleModeActive;
    const lt = document.getElementById('latinText');
    const legend = document.getElementById('styleLegend');
    const btn = event.currentTarget;

    if (styleModeActive) {
        lt.classList.add('style-mode');
        legend.classList.add('visible');
        btn.classList.add('active');
        hidePopup();
    } else {
        lt.classList.remove('style-mode');
        legend.classList.remove('visible');
        btn.classList.remove('active');
        hideStylePopup();
    }
}

function showStylePopup(e, styleKey) {
    const popup = document.getElementById('stylePopup');
    const data = styleData[styleKey];

    if (!data) {
        popup.classList.remove('visible');
        return;
    }

    const tierLabels = { 1: 'Sound & Rhetoric', 2: 'Dramatic Technique', 3: 'Structure & Word Order' };

    popup.innerHTML = `
        <div class="style-badge tier-${data.tier}">${tierLabels[data.tier]}</div>
        <h4>"${data.latin}"</h4>
        <div class="device-name">${data.device}</div>
        <div class="effect">${data.effect}</div>
    `;

    const rect = e.target.getBoundingClientRect();
    let left = rect.left + rect.width/2 - 210;
    let top = rect.bottom + 12;

    if (left < 10) left = 10;
    if (left + 420 > window.innerWidth - 10) left = window.innerWidth - 430;
    if (top + 200 > window.innerHeight) {
        top = rect.top - 212;
    }

    popup.style.left = left + 'px';
    popup.style.top = top + 'px';
    popup.classList.add('visible');
}

function hideStylePopup() {
    document.getElementById('stylePopup').classList.remove('visible');
}

function generateLatinHTML() {
    let html = '';
    latinSentences.forEach((s, i) => {
        const tokens = s.match(/[a-zA-Z]+[.,;:?!]*|[.,;:?!]+/g);
        html += '<p><span class="line-number">' + (i + 1) + '</span><span class="line-content">';
        if (tokens) {
            let sentenceText = tokens.join(' ');

            // Style markup for this sentence
            const styleMarkup = {
                1: [{ words: "pavore exanimis", key: "pavore_exanimis", tier: 2 }, { words: "iam iamque", key: "iam_iamque", tier: 1 }],
                2: [{ words: "sive servitia armaret vel militem accenderet", key: "sive_vel_ad", tier: 3 }, { words: "naufragium et vulnus et interfectos amicos", key: "naufragium_et_vulnus", tier: 1 }],
                4: [{ words: "longum utriusque silentium", key: "longum_silentium", tier: 2 }, { words: "pereundum Neroni esset", key: "pereundum_neroni", tier: 3 }],
                6: [{ words: "memoresque Germanici", key: "memoresque_germanici", tier: 2 }],
                7: [{ words: "summam sceleris", key: "summam_sceleris", tier: 2 }],
                8: [{ words: "illo die sibi dari imperium", key: "illo_die_imperium", tier: 2 }],
                9: [{ words: "scaenam ultro criminis parat", key: "scaenam_criminis", tier: 2 }, { words: "confingeret", key: "confingeret", tier: 3 }]
            };

            tokens.forEach((t, j) => {
                const m = t.match(/^([a-zA-Z]+)([.,;:?!]*)$/);
                if (m) {
                    const word = m[1];
                    const punct = m[2];
                    const lowerWord = word.toLowerCase();

                    // Check if this word is part of a style phrase
                    let styleClass = '';
                    let styleKey = '';
                    if (styleMarkup[i]) {
                        for (const markup of styleMarkup[i]) {
                            if (markup.words.toLowerCase().includes(lowerWord)) {
                                styleClass = `style-tier-${markup.tier}`;
                                styleKey = markup.key;
                                break;
                            }
                        }
                    }

                    if (styleClass) {
                        html += `<span class="word ${styleClass}" data-word="${lowerWord}" data-style="${styleKey}">${word}</span>${punct}`;
                    } else {
                        html += `<span class="word" data-word="${lowerWord}">${word}</span>${punct}`;
                    }
                    if (j < tokens.length - 1) html += ' ';
                } else {
                    html += t + ' ';
                }
            });
        }
        html += '</span></p>';
    });
    return html;
}

function showVocabPopup(e, word) {
    const popup = document.getElementById('vocabPopup');
    const data = vocab[word.toLowerCase()];
    document.querySelectorAll('.word.active').forEach(w => w.classList.remove('active'));
    if (!data) { popup.classList.remove('visible'); return; }
    e.target.classList.add('active');
    popup.innerHTML = `<h4>${word}</h4><div class="parsing">${data.parsing}</div><div class="meaning">${data.meaning}</div><div class="principal-parts">${data.lemma}</div>`;
    const rect = e.target.getBoundingClientRect();
    let left = rect.left + rect.width/2 - 150, top = rect.bottom + 12, ab = false;
    if (left < 10) left = 10;
    if (left + 300 > window.innerWidth - 10) left = window.innerWidth - 310;
    if (top + 150 > window.innerHeight) { top = rect.top - 162; ab = true; }
    popup.style.left = left + 'px';
    popup.style.top = top + 'px';
    popup.style.setProperty('--arrow-left', Math.max(20, Math.min(280, rect.left + rect.width/2 - left)) + 'px');
    popup.classList.toggle('arrow-bottom', ab);
    popup.classList.add('visible');
}

function hidePopup() {
    document.getElementById('vocabPopup').classList.remove('visible');
    document.querySelectorAll('.word.active').forEach(w => w.classList.remove('active'));
}

function toggleTranslation() {
    const box = document.getElementById('translationBox');
    const btn = event.currentTarget;
    const active = box.classList.toggle('active');
    btn.textContent = active ? 'Hide Translation' : 'Translation';
    btn.classList.toggle('active', active);
}

function showView(view) {
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    event.currentTarget.classList.add('active');
    const tc = document.getElementById('textCard');
    const rc = document.getElementById('resourceCard');
    if (view === 'text') {
        tc.style.display = 'block';
        rc.style.display = 'none';
    } else {
        tc.style.display = 'none';
        rc.style.display = 'block';
        document.getElementById('resourceTitle').textContent = view.charAt(0).toUpperCase() + view.slice(1);
        document.getElementById('resourceContent').innerHTML = resources[view];
    }
}

document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('latinText').innerHTML = generateLatinHTML();

    if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelectorAll('.btn').forEach(b => {
            if (b.textContent.includes('Dark')) {
                b.textContent = '‚òÄÔ∏è Light';
                b.classList.add('active');
            }
        });
    }

    if (localStorage.getItem('lineNumbers') === 'true') {
        document.getElementById('latinText').classList.add('show-lines');
        document.querySelectorAll('.btn').forEach(b => {
            if (b.textContent === 'Line Numbers') b.classList.add('active');
        });
    }

    document.querySelectorAll('.word').forEach(w => w.addEventListener('click', function(e) {
        e.stopPropagation();
        if (pointerModeActive) {
            this.classList.toggle('pointed');
        } else if (styleModeActive && this.dataset.style) {
            hidePopup();
            showStylePopup(e, this.dataset.style);
        } else {
            hideStylePopup();
            showVocabPopup(e, this.dataset.word);
        }
    }));

    document.addEventListener('click', e => {
        if (!e.target.classList.contains('word')) {
            hidePopup();
            hideStylePopup();
            if (pointerModeActive && !e.target.closest('.btn-group')) {
                document.querySelectorAll('.word.pointed').forEach(w => w.classList.remove('pointed'));
            }
        }
    });

    document.addEventListener('keydown', e => {
        if (e.key === 'Escape') {
            if (document.body.classList.contains('full-screen')) {
                document.body.classList.remove('full-screen');
                document.querySelectorAll('.btn').forEach(b => {
                    if (b.textContent.includes('Full Screen')) {
                        b.textContent = '‚õ∂ Full Screen';
                        b.classList.remove('active');
                    }
                });
            }
            if (pointerModeActive) {
                pointerModeActive = false;
                document.body.classList.remove('pointer-mode');
                document.querySelectorAll('.word.pointed').forEach(w => w.classList.remove('pointed'));
            }
            hideStylePopup();
        }
        if (sentenceModeActive && e.key === 'ArrowLeft') prevSentence();
        if (sentenceModeActive && e.key === 'ArrowRight') nextSentence();
    });
});
    </script>
</body>
</html>
