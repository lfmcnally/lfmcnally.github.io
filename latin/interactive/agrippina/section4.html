<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classicalia - Tacitus Annals 14.4</title>
    <link rel="icon" type="image/png" href="/images/favicon.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            display: flex;
        }

        .sidebar {
            width: 240px;
            background: white;
            border-right: 1px solid #e5e7eb;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .logo-section {
            padding: 1.5rem 1.25rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #0066ff 0%, #4d94ff 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            font-size: 1.1rem;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1f2937;
        }

        .nav-section {
            padding: 1rem 0.5rem;
        }

        .nav-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #9ca3af;
            letter-spacing: 0.05em;
            padding: 0 0.75rem;
            margin-bottom: 0.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.625rem 0.75rem;
            margin: 0.125rem 0;
            border-radius: 8px;
            text-decoration: none;
            color: #4b5563;
            font-size: 0.9rem;
            transition: all 0.15s ease;
            cursor: pointer;
        }

        .nav-item:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .nav-item.active {
            background: #eef2ff;
            color: #0066ff;
            font-weight: 500;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .main-content {
            margin-left: 240px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .top-bar {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 0.875rem 2rem;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .content-wrapper {
            flex: 1;
            overflow-y: auto;
        }

        .content-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .lesson-header {
            margin-bottom: 2rem;
        }

        .lesson-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .lesson-meta {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .lesson-layout {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 1.5rem;
            align-items: start;
        }

        .card {
            background: white;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }

        .card-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
        }

        .card-body {
            padding: 1.5rem;
        }

        .tabs {
            display: flex;
            gap: 0.25rem;
            background: #f3f4f6;
            padding: 0.25rem;
            border-radius: 8px;
        }

        .tab {
            flex: 1;
            padding: 0.5rem 1rem;
            background: transparent;
            border: none;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .tab.active {
            background: white;
            color: #0066ff;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .latin-text {
            font-size: 1.25rem;
            line-height: 2.2;
            color: #1f2937;
            margin: 1.5rem 0;
        }

        .phrase {
            cursor: pointer;
            padding: 3px 6px;
            margin: 0 2px;
            border-radius: 4px;
            transition: all 0.2s ease;
            display: inline;
        }

        .phrase.phrase-1 { background: rgba(76, 175, 80, 0.15); }
        .phrase.phrase-1:hover { background: rgba(76, 175, 80, 0.3); }
        .phrase.phrase-2 { background: rgba(33, 150, 243, 0.15); }
        .phrase.phrase-2:hover { background: rgba(33, 150, 243, 0.3); }
        .phrase.phrase-3 { background: rgba(156, 39, 176, 0.15); }
        .phrase.phrase-3:hover { background: rgba(156, 39, 176, 0.3); }
        .phrase.phrase-4 { background: rgba(255, 152, 0, 0.15); }
        .phrase.phrase-4:hover { background: rgba(255, 152, 0, 0.3); }
        .phrase.phrase-5 { background: rgba(244, 67, 54, 0.15); }
        .phrase.phrase-5:hover { background: rgba(244, 67, 54, 0.3); }
        .phrase.phrase-6 { background: rgba(0, 188, 212, 0.15); }
        .phrase.phrase-6:hover { background: rgba(0, 188, 212, 0.3); }
        .phrase.phrase-7 { background: rgba(76, 175, 80, 0.15); }
        .phrase.phrase-7:hover { background: rgba(76, 175, 80, 0.3); }
        .phrase.phrase-8 { background: rgba(33, 150, 243, 0.15); }
        .phrase.phrase-8:hover { background: rgba(33, 150, 243, 0.3); }
        .phrase.phrase-9 { background: rgba(156, 39, 176, 0.15); }
        .phrase.phrase-9:hover { background: rgba(156, 39, 176, 0.3); }
        .phrase.phrase-10 { background: rgba(255, 152, 0, 0.15); }
        .phrase.phrase-10:hover { background: rgba(255, 152, 0, 0.3); }
        .phrase.phrase-11 { background: rgba(244, 67, 54, 0.15); }
        .phrase.phrase-11:hover { background: rgba(244, 67, 54, 0.3); }
        .phrase.phrase-12 { background: rgba(0, 188, 212, 0.15); }
        .phrase.phrase-12:hover { background: rgba(0, 188, 212, 0.3); }
        .phrase.phrase-13 { background: rgba(76, 175, 80, 0.15); }
        .phrase.phrase-13:hover { background: rgba(76, 175, 80, 0.3); }
        .phrase.phrase-14 { background: rgba(33, 150, 243, 0.15); }
        .phrase.phrase-14:hover { background: rgba(33, 150, 243, 0.3); }
        .phrase.phrase-15 { background: rgba(156, 39, 176, 0.15); }
        .phrase.phrase-15:hover { background: rgba(156, 39, 176, 0.3); }
        .phrase.phrase-16 { background: rgba(255, 152, 0, 0.15); }
        .phrase.phrase-16:hover { background: rgba(255, 152, 0, 0.3); }
        .phrase.phrase-17 { background: rgba(244, 67, 54, 0.15); }
        .phrase.phrase-17:hover { background: rgba(244, 67, 54, 0.3); }
        .phrase.phrase-18 { background: rgba(0, 188, 212, 0.15); }
        .phrase.phrase-18:hover { background: rgba(0, 188, 212, 0.3); }
        .phrase.phrase-19 { background: rgba(76, 175, 80, 0.15); }
        .phrase.phrase-19:hover { background: rgba(76, 175, 80, 0.3); }
        .phrase.phrase-20 { background: rgba(33, 150, 243, 0.15); }
        .phrase.phrase-20:hover { background: rgba(33, 150, 243, 0.3); }
        .phrase.phrase-21 { background: rgba(156, 39, 176, 0.15); }
        .phrase.phrase-21:hover { background: rgba(156, 39, 176, 0.3); }
        .phrase.phrase-22 { background: rgba(255, 152, 0, 0.15); }
        .phrase.phrase-22:hover { background: rgba(255, 152, 0, 0.3); }
        .phrase.phrase-23 { background: rgba(244, 67, 54, 0.15); }
        .phrase.phrase-23:hover { background: rgba(244, 67, 54, 0.3); }
        .phrase.phrase-24 { background: rgba(0, 188, 212, 0.15); }
        .phrase.phrase-24:hover { background: rgba(0, 188, 212, 0.3); }
        .phrase.phrase-25 { background: rgba(76, 175, 80, 0.15); }
        .phrase.phrase-25:hover { background: rgba(76, 175, 80, 0.3); }
        .phrase.phrase-26 { background: rgba(33, 150, 243, 0.15); }
        .phrase.phrase-26:hover { background: rgba(33, 150, 243, 0.3); }
        .phrase.phrase-27 { background: rgba(156, 39, 176, 0.15); }
        .phrase.phrase-27:hover { background: rgba(156, 39, 176, 0.3); }
        .phrase.phrase-28 { background: rgba(255, 152, 0, 0.15); }
        .phrase.phrase-28:hover { background: rgba(255, 152, 0, 0.3); }
        .phrase.phrase-29 { background: rgba(244, 67, 54, 0.15); }
        .phrase.phrase-29:hover { background: rgba(244, 67, 54, 0.3); }
        .phrase.phrase-30 { background: rgba(0, 188, 212, 0.15); }
        .phrase.phrase-30:hover { background: rgba(0, 188, 212, 0.3); }

        .highlight-style {
            cursor: pointer;
            padding: 3px 6px;
            margin: 0 2px;
            border-radius: 4px;
            transition: all 0.2s ease;
            display: inline;
            background: rgba(156, 163, 175, 0.2);
        }

        .highlight-style:hover {
            background: rgba(156, 163, 175, 0.35);
        }

        /* Active highlighting colours for different patterns */
        .highlight-style.active-a { background: rgba(59, 130, 246, 0.45) !important; }
        .highlight-style.active-b { background: rgba(239, 68, 68, 0.45) !important; }
        .highlight-style.active-c { background: rgba(34, 197, 94, 0.45) !important; }
        .highlight-style.active-d { background: rgba(168, 85, 247, 0.45) !important; }
        .highlight-style.active-single { background: rgba(234, 179, 8, 0.45) !important; }

        .mode-style .phrase {
            background: transparent !important;
            cursor: default;
        }

        .latin-text:not(.mode-style) .highlight-style {
            background: transparent;
            cursor: default;
            padding: 0;
        }

        .analysis-card {
            background: #f9fafb;
            border-radius: 8px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
            display: none;
        }

        .analysis-card.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .analysis-badge {
            display: inline-block;
            padding: 0.25rem 0.625rem;
            background: rgba(0, 102, 255, 0.1);
            color: #0066ff;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
        }

        .analysis-card h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 0.75rem;
        }

        .analysis-card p {
            font-size: 0.875rem;
            line-height: 1.6;
            color: #4b5563;
            margin-bottom: 0.5rem;
        }

        .analysis-card .vocab-list {
            font-size: 0.85rem;
            line-height: 1.7;
            color: #4b5563;
            margin: 0.5rem 0;
        }

        .analysis-card strong {
            color: #0066ff;
        }

        .translation-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .translation-text {
            display: none;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #059669;
            margin-top: 0.5rem;
            padding: 0.75rem;
            background: rgba(5, 150, 105, 0.05);
            border-radius: 6px;
            border-left: 3px solid #059669;
        }

        .translation-text.visible {
            display: block;
        }

        .reveal-translation-btn {
            background: #0066ff;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reveal-translation-btn:hover {
            background: #0052cc;
        }

        .reveal-translation-btn.revealed {
            background: #10b981;
        }

        .reveal-translation-btn.revealed:hover {
            background: #059669;
        }

        .btn-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            transition: all 0.15s ease;
        }

        .btn:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .default-message {
            text-align: center;
            padding: 2rem 1rem;
            color: #9ca3af;
            font-style: italic;
            font-size: 0.9rem;
        }

        .learning-objectives {
            background: linear-gradient(135deg, #eef2ff 0%, #f0f9ff 100%);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #dbeafe;
        }

        .learning-objectives h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .learning-objectives p {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .success-criteria {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .success-criteria h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .success-criteria ul {
            list-style: none;
            padding: 0;
        }

        .success-criteria li {
            font-size: 0.875rem;
            line-height: 1.6;
            color: #4b5563;
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }

        .success-criteria li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: bold;
        }

        @media (max-width: 1024px) {
            .lesson-layout {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="logo-section">
            <a href="../../../index.html" class="logo">
                <div class="logo-icon">C</div>
                <span class="logo-text">Classicalia</span>
            </a>
        </div>

        <nav class="nav-section">
            <div class="nav-title">Resources</div>
            <div class="nav-item active" onclick="showView('objectives')">
                <span class="nav-icon">üéØ</span>
                <span>Learning Intentions</span>
            </div>
            <div class="nav-item" onclick="showView('text')">
                <span class="nav-icon">üìñ</span>
                <span>Read</span>
            </div>
        </nav>
    </aside>

    <main class="main-content">
        <div class="top-bar"></div>

        <div class="content-wrapper">
            <div class="content-container">
                <header class="lesson-header">
                    <h1 class="lesson-title">The Invitation to Baiae</h1>
                    <div class="lesson-meta">
                        <span>üìï Tacitus Annals 14.4</span>
                        <span>‚è±Ô∏è 60 min</span>
                        <span>üìä A-Level</span>
                    </div>
                </header>

                <div class="lesson-layout">
                    <div>
                        <div class="card" id="objectivesCard">
                            <div class="card-body">
                                <div class="learning-objectives">
                                    <h3>üéØ Learning Intention</h3>
                                    <p>Understand how Tacitus presents the elaborate deception and psychological manipulation as Nero lures Agrippina to her death.</p>
                                    
                                    <div class="success-criteria">
                                        <h4>Success Criteria</h4>
                                        <ul>
                                            <li>I can analyse how Tacitus uses the Quinquatrus festival as narrative cover for murder</li>
                                            <li>I can explain the significance of Nero's physical gestures (hand, embrace) as performance masking murderous intent</li>
                                            <li>I can evaluate Tacitus' characterisation through the "easy female credulity" comment</li>
                                            <li>I can identify the ambiguity in Nero's final embrace and its dramatic effect</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card" id="textCard" style="display: none;">
                            <div class="card-header">
                                <h3 class="card-title">Latin Text</h3>
                                <div class="tabs">
                                    <button class="tab active" onclick="setMode('grammar')">Grammar</button>
                                    <button class="tab" onclick="setMode('style')">Style</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="latin-text" id="latinText"></div>
                                
                                <div class="btn-group">
                                    <button class="btn" onclick="toggleFullTranslation()">Show Translation</button>
                                    <button class="btn" onclick="resetView()">Reset View</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="card">
                            <div class="card-header">
                                <h3 class="card-title" id="panelTitle">Getting Started</h3>
                            </div>
                            <div class="card-body" id="analysisPanel">
                                <div class="default-message" id="defaultMessage">
                                    Begin by reviewing the learning intentions, then move to the Read section to explore the Latin text
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const lessonData = {
            latinText: `<span class="phrase phrase-1" onclick="showAnalysis('phrase-1')"><span class="highlight-style" data-style="style-1" data-pattern="single" onclick="showStyleAnalysis('style-1'); event.stopPropagation();">placuit sollertia,</span></span> <span class="phrase phrase-2" onclick="showAnalysis('phrase-2')"><span class="highlight-style" data-style="style-2" data-pattern="single" onclick="showStyleAnalysis('style-2'); event.stopPropagation();">tempore etiam iuta,</span></span> <span class="phrase phrase-3" onclick="showAnalysis('phrase-3')">quando <span class="highlight-style" data-style="style-3" data-pattern="single" onclick="showStyleAnalysis('style-3'); event.stopPropagation();">Quinquatruum festos dies</span> apud <span class="highlight-style" data-style="style-21" data-pattern="a" onclick="showStyleAnalysis('style-21'); event.stopPropagation();">Baias</span> frequentabat.</span> <span class="phrase phrase-4" onclick="showAnalysis('phrase-4')">illuc matrem <span class="highlight-style" data-style="style-22" data-pattern="single" onclick="showStyleAnalysis('style-22'); event.stopPropagation();">elicit,</span></span> <span class="phrase phrase-5" onclick="showAnalysis('phrase-5')"><span class="highlight-style" data-style="style-23" data-pattern="a" onclick="showStyleAnalysis('style-23'); event.stopPropagation();">fere<u>n</u>das</span> parentium <span class="highlight-style" data-style="style-23" data-pattern="b" onclick="showStyleAnalysis('style-23'); event.stopPropagation();">iracu<u>n</u>dias</span> et <span class="highlight-style" data-style="style-23" data-pattern="c" onclick="showStyleAnalysis('style-23'); event.stopPropagation();">placa<u>n</u>dum a<u>n</u>imum</span> <span class="highlight-style" data-style="style-4" data-pattern="single" onclick="showStyleAnalysis('style-4'); event.stopPropagation();">dictitans</span></span> <span class="phrase phrase-6" onclick="showAnalysis('phrase-6')">quo <span class="highlight-style" data-style="style-5" data-pattern="single" onclick="showStyleAnalysis('style-5'); event.stopPropagation();">rumorem reconciliationis</span> efficeret</span> <span class="phrase phrase-7" onclick="showAnalysis('phrase-7')">acciperet<span class="highlight-style" data-style="style-6" data-pattern="single" onclick="showStyleAnalysis('style-6'); event.stopPropagation();">que Agrippina facili feminarum credulitate ad gaudia.</span></span> <span class="phrase phrase-8" onclick="showAnalysis('phrase-8')"><span class="highlight-style" data-style="style-7" data-pattern="single" onclick="showStyleAnalysis('style-7'); event.stopPropagation();">venientem dehinc obvius</span> in litora</span> <span class="phrase phrase-9" onclick="showAnalysis('phrase-9')"><span class="highlight-style" data-style="style-17" data-pattern="single" onclick="showStyleAnalysis('style-17'); event.stopPropagation();">(nam Antio adventabat)</span></span> <span class="phrase phrase-10" onclick="showAnalysis('phrase-10')">excepit <span class="highlight-style" data-style="style-8" data-pattern="a" onclick="showStyleAnalysis('style-8'); event.stopPropagation();">manu</span> <span class="highlight-style" data-style="style-16" data-pattern="a" onclick="showStyleAnalysis('style-16'); event.stopPropagation();">et</span> <span class="highlight-style" data-style="style-8" data-pattern="b" onclick="showStyleAnalysis('style-8'); event.stopPropagation();">complexu</span></span> <span class="phrase phrase-11" onclick="showAnalysis('phrase-11')">ducit<span class="highlight-style" data-style="style-16" data-pattern="b" onclick="showStyleAnalysis('style-16'); event.stopPropagation();">que</span> <span class="highlight-style" data-style="style-9" data-pattern="single" onclick="showStyleAnalysis('style-9'); event.stopPropagation();">Baulos.</span></span> <span class="phrase phrase-12" onclick="showAnalysis('phrase-12')">id villae nomen est</span> <span class="phrase phrase-13" onclick="showAnalysis('phrase-13')">quae promunturium <span class="highlight-style" data-style="style-24" data-pattern="a" onclick="showStyleAnalysis('style-24'); event.stopPropagation();">Misenum</span> inter et <span class="highlight-style" data-style="style-24" data-pattern="b" onclick="showStyleAnalysis('style-24'); event.stopPropagation();">Baianum</span> lacum flexo mari adluitur.</span> <span class="phrase phrase-14" onclick="showAnalysis('phrase-14')">stabat inter alias navis <span class="highlight-style" data-style="style-10" data-pattern="single" onclick="showStyleAnalysis('style-10'); event.stopPropagation();">ornatior,</span></span> <span class="phrase phrase-15" onclick="showAnalysis('phrase-15')"><span class="highlight-style" data-style="style-11" data-pattern="single" onclick="showStyleAnalysis('style-11'); event.stopPropagation();">tamquam id quoque honori matris daretur:</span></span> <span class="phrase phrase-16" onclick="showAnalysis('phrase-16')">quippe sueverat <span class="highlight-style" data-style="style-25" data-pattern="a" onclick="showStyleAnalysis('style-25'); event.stopPropagation();">triremi</span> et <span class="highlight-style" data-style="style-25" data-pattern="b" onclick="showStyleAnalysis('style-25'); event.stopPropagation();">classiariorum remigio</span> vehi.</span> <span class="phrase phrase-17" onclick="showAnalysis('phrase-17')">ac tum invitata ad <span class="highlight-style" data-style="style-26" data-pattern="single" onclick="showStyleAnalysis('style-26'); event.stopPropagation();">epulas</span> erat</span> <span class="phrase phrase-18" onclick="showAnalysis('phrase-18')"><span class="highlight-style" data-style="style-12" data-pattern="single" onclick="showStyleAnalysis('style-12'); event.stopPropagation();">ut occultando facinori nox adhiberetur.</span></span> <span class="phrase phrase-19" onclick="showAnalysis('phrase-19')"><span class="highlight-style" data-style="style-13" data-pattern="single" onclick="showStyleAnalysis('style-13'); event.stopPropagation();">satis constitit</span> extitisse <span class="highlight-style" data-style="style-27" data-pattern="single" onclick="showStyleAnalysis('style-27'); event.stopPropagation();">proditorem</span></span> <span class="phrase phrase-20" onclick="showAnalysis('phrase-20')">et Agrippinam auditis insidiis,</span> <span class="phrase phrase-21" onclick="showAnalysis('phrase-21')"><span class="highlight-style" data-style="style-14" data-pattern="single" onclick="showStyleAnalysis('style-14'); event.stopPropagation();">an crederet ambiguam,</span></span> <span class="phrase phrase-22" onclick="showAnalysis('phrase-22')">gestamine sellae <span class="highlight-style" data-style="style-21" data-pattern="b" onclick="showStyleAnalysis('style-21'); event.stopPropagation();">Baias</span> pervectam.</span> <span class="phrase phrase-23" onclick="showAnalysis('phrase-23')">ibi <span class="highlight-style" data-style="style-28" data-pattern="single" onclick="showStyleAnalysis('style-28'); event.stopPropagation();">blandimentum</span> sublevavit metum:</span> <span class="phrase phrase-24" onclick="showAnalysis('phrase-24')"><span class="highlight-style" data-style="style-15" data-pattern="single" onclick="showStyleAnalysis('style-15'); event.stopPropagation();">comiter excepta superque ipsum conlocata.</span></span> <span class="phrase phrase-25" onclick="showAnalysis('phrase-25')">iam pluribus sermonibus <span class="highlight-style" data-style="style-18" data-pattern="a" onclick="showStyleAnalysis('style-18'); event.stopPropagation();">modo</span> familiaritate iuvenili Nero</span> <span class="phrase phrase-26" onclick="showAnalysis('phrase-26')">et <span class="highlight-style" data-style="style-18" data-pattern="b" onclick="showStyleAnalysis('style-18'); event.stopPropagation();">rursus</span> adductus,</span> <span class="phrase phrase-27" onclick="showAnalysis('phrase-27')"><span class="highlight-style" data-style="style-18" data-pattern="c" onclick="showStyleAnalysis('style-18'); event.stopPropagation();">quasi</span> seria consociaret,</span> <span class="phrase phrase-28" onclick="showAnalysis('phrase-28')">tracto in longum convictu,</span> <span class="phrase phrase-29" onclick="showAnalysis('phrase-29')">prosequitur abeuntem,</span> <span class="phrase phrase-30" onclick="showAnalysis('phrase-30');"><span class="highlight-style" data-style="style-20" data-pattern="a" onclick="showStyleAnalysis('style-20'); event.stopPropagation();">artius</span> oculis et pectori haerens, <span class="highlight-style" data-style="style-19" data-pattern="a" onclick="showStyleAnalysis('style-19'); event.stopPropagation();">sive</span> explenda simulatione, <span class="highlight-style" data-style="style-19" data-pattern="b" onclick="showStyleAnalysis('style-19'); event.stopPropagation();">seu</span> periturae matris <span class="highlight-style" data-style="style-20" data-pattern="b" onclick="showStyleAnalysis('style-20'); event.stopPropagation();">supremus</span> aspectus <span class="highlight-style" data-style="style-20" data-pattern="c" onclick="showStyleAnalysis('style-20'); event.stopPropagation();">quamvis ferum</span> animum retinebat.</span>`,

            fullTranslation: `Ingenuity was decided upon, which was also helped by time, since (Nero) was visiting the festival of the Quinquatrus at Baiae. He enticed his mother there, repeatedly saying that the angry feelings of parents had to be put up with and any hostile feeling should be appeased, so that he might create a (false) report of reconciliation and Agrippina might receive it, since women readily believe in joyful events. Then as she came onto the shores (for she was coming from Antium), he met her, welcomed her with his hand and an embrace and escorted her to Bauli. That is the name of the villa which (lying) between Cape Misenum and the Baian lake, is washed by a bend in the sea. A more elaborate ship stood among the others, as if this, too, was to be given as an honour to his mother: for she had been accustomed to sail in a trireme and with oars pulled by marines. And then she had been invited to a banquet, so that darkness could be used to hide the crime. It was sufficiently well-known that an informer appeared, and when Agrippina heard of the plot, uncertain as to whether to believe it, was carried to Baiae by a sedan chair. There flattery alleviated her fear: she was graciously received and placed above (Nero) himself (at the table). Now with many conversations, now with youthful friendship, then again stern as if he was sharing serious topics, having dragged out the banquet for a long time, Nero escorted her as she departed, cleaving more closely to her eyes and her breast, whether because he was bolstering up his pretence or the last sight of his doomed mother repressed his feelings, however savage they were.`,

            grammar: {
                'phrase-1': {
                    title: 'placuit sollertia',
                    vocab: [
                        '<strong>placuit</strong> - it pleased, it was decided (perfect, 3rd sing.)',
                        '<strong>sollertia</strong> - ingenuity, cleverness (nominative)'
                    ],
                    grammar: 'Impersonal verb "placuit" with nominative subject. The perfect tense marks decisive action.',
                    translation: 'Ingenuity was decided upon'
                },
                'phrase-2': {
                    title: 'tempore etiam iuta',
                    vocab: [
                        '<strong>tempore</strong> - by time, by timing (ablative of means)',
                        '<strong>etiam</strong> - also, even',
                        '<strong>iuta</strong> - helped, assisted (perfect participle, nominative)'
                    ],
                    grammar: 'Perfect passive participle agreeing with "sollertia". Ablative of means.',
                    translation: 'which was also helped by time/timing'
                },
                'phrase-3': {
                    title: 'quando Quinquatruum festos dies apud Baias frequentabat',
                    vocab: [
                        '<strong>quando</strong> - since, because',
                        '<strong>Quinquatruum</strong> - of the Quinquatrus (genitive)',
                        '<strong>festos dies</strong> - festival days (accusative plural)',
                        '<strong>apud Baias</strong> - at Baiae',
                        '<strong>frequentabat</strong> - he was visiting (imperfect, 3rd sing.)'
                    ],
                    grammar: '"Quando" introduces causal clause. Imperfect tense shows ongoing action.',
                    translation: 'since (Nero) was visiting the festival days of the Quinquatrus at Baiae'
                },
                'phrase-4': {
                    title: 'illuc matrem elicit',
                    vocab: [
                        '<strong>illuc</strong> - to that place, there',
                        '<strong>matrem</strong> - mother (accusative)',
                        '<strong>elicit</strong> - he entices, he lures (present, 3rd sing.)'
                    ],
                    grammar: 'Historic present for vividness. "Illuc" is adverb of place to which.',
                    translation: 'He entices (his) mother there'
                },
                'phrase-5': {
                    title: 'ferendas parentium iracundias et placandum animum dictitans',
                    vocab: [
                        '<strong>ferendas</strong> - (things) to be endured (gerundive, accusative plural)',
                        '<strong>parentium</strong> - of parents (genitive)',
                        '<strong>iracundias</strong> - angry feelings (accusative plural)',
                        '<strong>placandum</strong> - to be appeased (gerundive, accusative)',
                        '<strong>animum</strong> - hostile feeling (accusative)',
                        '<strong>dictitans</strong> - repeatedly saying (present participle)'
                    ],
                    grammar: 'Gerundives expressing necessity in indirect statement. Frequentative "dictitans" emphasises repetition.',
                    translation: 'repeatedly saying that parents\' angry feelings had to be endured and hostile feeling had to be appeased'
                },
                'phrase-6': {
                    title: 'quo rumorem reconciliationis efficeret',
                    vocab: [
                        '<strong>quo</strong> - so that (purpose conjunction)',
                        '<strong>rumorem</strong> - report, rumour (accusative)',
                        '<strong>reconciliationis</strong> - of reconciliation (genitive)',
                        '<strong>efficeret</strong> - he might create (imperfect subjunctive)'
                    ],
                    grammar: 'Purpose clause with imperfect subjunctive in secondary sequence.',
                    translation: 'so that he might create a report of reconciliation'
                },
                'phrase-7': {
                    title: 'acciperetque Agrippina facili feminarum credulitate ad gaudia',
                    vocab: [
                        '<strong>acciperet</strong> - she might receive (imperfect subjunctive)',
                        '<strong>-que</strong> - and',
                        '<strong>Agrippina</strong> - Agrippina (nominative)',
                        '<strong>facili credulitate</strong> - with easy/ready credulity (ablative)',
                        '<strong>feminarum</strong> - of women (genitive)',
                        '<strong>ad gaudia</strong> - towards joys (accusative with prep.)'
                    ],
                    grammar: 'Continued purpose clause. "Feminarum" is partitive genitive. "Ad" shows direction of belief.',
                    translation: 'and Agrippina might receive (it) with women\'s ready belief in joyful things'
                },
                'phrase-8': {
                    title: 'venientem dehinc obvius in litora',
                    vocab: [
                        '<strong>venientem</strong> - (her) coming (present participle, accusative)',
                        '<strong>dehinc</strong> - then, next',
                        '<strong>obvius</strong> - meeting (nominative)',
                        '<strong>in litora</strong> - to the shores (accusative with prep.)'
                    ],
                    grammar: 'Present participle as substantive. "Obvius" agrees with understood Nero.',
                    translation: 'then (Nero), meeting (her) coming onto the shores'
                },
                'phrase-9': {
                    title: '(nam Antio adventabat)',
                    vocab: [
                        '<strong>nam</strong> - for',
                        '<strong>Antio</strong> - from Antium (ablative of place from which)',
                        '<strong>adventabat</strong> - she was coming (imperfect, 3rd sing.)'
                    ],
                    grammar: 'Parenthetical explanation. Ablative of place from which without preposition.',
                    translation: '(for she was coming from Antium)'
                },
                'phrase-10': {
                    title: 'excepit manu et complexu',
                    vocab: [
                        '<strong>excepit</strong> - he welcomed, he received (perfect, 3rd sing.)',
                        '<strong>manu</strong> - with (his) hand (ablative of means)',
                        '<strong>et</strong> - and',
                        '<strong>complexu</strong> - with an embrace (ablative of means)'
                    ],
                    grammar: 'Ablatives of means/manner. Physical gestures emphasised.',
                    translation: 'he welcomed (her) with (his) hand and an embrace'
                },
                'phrase-11': {
                    title: 'ducitque Baulos',
                    vocab: [
                        '<strong>ducit</strong> - he leads, he escorts (present, 3rd sing.)',
                        '<strong>-que</strong> - and',
                        '<strong>Baulos</strong> - to Bauli (accusative of place to which)'
                    ],
                    grammar: 'Historic present. Accusative of place to which without preposition (town name).',
                    translation: 'and he escorts (her) to Bauli'
                },
                'phrase-12': {
                    title: 'id villae nomen est',
                    vocab: [
                        '<strong>id</strong> - that, this (nominative)',
                        '<strong>villae</strong> - of the villa (genitive)',
                        '<strong>nomen</strong> - name (nominative)',
                        '<strong>est</strong> - is (present, 3rd sing.)'
                    ],
                    grammar: 'Simple copula construction. Genitive of possession.',
                    translation: 'That is the name of the villa'
                },
                'phrase-13': {
                    title: 'quae promunturium Misenum inter et Baianum lacum flexo mari adluitur',
                    vocab: [
                        '<strong>quae</strong> - which (nominative relative)',
                        '<strong>promunturium Misenum</strong> - Cape Misenum (accusative)',
                        '<strong>inter...et</strong> - between...and',
                        '<strong>Baianum lacum</strong> - Baian lake (accusative)',
                        '<strong>flexo mari</strong> - by the curved/winding sea (ablative absolute)',
                        '<strong>adluitur</strong> - is washed (present passive)'
                    ],
                    grammar: 'Relative clause. Ablative absolute. Compound preposition "inter...et".',
                    translation: 'which is washed by the winding sea between Cape Misenum and the Baian lake'
                },
                'phrase-14': {
                    title: 'stabat inter alias navis ornatior',
                    vocab: [
                        '<strong>stabat</strong> - was standing (imperfect, 3rd sing.)',
                        '<strong>inter alias</strong> - among the others',
                        '<strong>navis</strong> - ship (nominative)',
                        '<strong>ornatior</strong> - more elaborate, more ornate (comparative adjective)'
                    ],
                    grammar: 'Imperfect sets scene. Comparative adjective for emphasis.',
                    translation: 'A more elaborate ship was standing among the others'
                },
                'phrase-15': {
                    title: 'tamquam id quoque honori matris daretur',
                    vocab: [
                        '<strong>tamquam</strong> - as if',
                        '<strong>id quoque</strong> - this too, this also',
                        '<strong>honori</strong> - for honour, as an honour (dative of purpose)',
                        '<strong>matris</strong> - of (his) mother (genitive)',
                        '<strong>daretur</strong> - might be given (imperfect subjunctive passive)'
                    ],
                    grammar: 'Comparative clause with subjunctive (pretence). Double dative construction.',
                    translation: 'as if this too was being given as an honour to (his) mother'
                },
                'phrase-16': {
                    title: 'quippe sueverat triremi et classiariorum remigio vehi',
                    vocab: [
                        '<strong>quippe</strong> - for indeed, naturally',
                        '<strong>sueverat</strong> - she had been accustomed (pluperfect, 3rd sing.)',
                        '<strong>triremi</strong> - in a trireme (ablative of means)',
                        '<strong>et</strong> - and',
                        '<strong>classiariorum</strong> - of marines (genitive)',
                        '<strong>remigio</strong> - with rowing, with oars (ablative of means)',
                        '<strong>vehi</strong> - to be carried, to sail (present passive infinitive)'
                    ],
                    grammar: 'Complementary infinitive with "sueverat". Ablatives of means.',
                    translation: 'for she had been accustomed to sail in a trireme with marines\' rowing'
                },
                'phrase-17': {
                    title: 'ac tum invitata ad epulas erat',
                    vocab: [
                        '<strong>ac</strong> - and',
                        '<strong>tum</strong> - then, at that time',
                        '<strong>invitata</strong> - having been invited (perfect participle)',
                        '<strong>ad epulas</strong> - to a banquet (accusative with prep.)',
                        '<strong>erat</strong> - she was (imperfect, 3rd sing.)'
                    ],
                    grammar: 'Pluperfect passive periphrastic. Perfect participle with "erat".',
                    translation: 'And then she had been invited to a banquet'
                },
                'phrase-18': {
                    title: 'ut occultando facinori nox adhiberetur',
                    vocab: [
                        '<strong>ut</strong> - so that (purpose)',
                        '<strong>occultando facinori</strong> - for hiding the crime (gerund dative of purpose)',
                        '<strong>nox</strong> - night, darkness (nominative)',
                        '<strong>adhiberetur</strong> - might be used (imperfect subjunctive passive)'
                    ],
                    grammar: 'Purpose clause. Gerund in dative expressing purpose.',
                    translation: 'so that darkness might be used for hiding the crime'
                },
                'phrase-19': {
                    title: 'satis constitit extitisse proditorem',
                    vocab: [
                        '<strong>satis</strong> - sufficiently, well enough',
                        '<strong>constitit</strong> - it is established, it is well-known (perfect, 3rd sing.)',
                        '<strong>extitisse</strong> - to have appeared (perfect infinitive)',
                        '<strong>proditorem</strong> - informer, betrayer (accusative)'
                    ],
                    grammar: 'Impersonal "constitit" with infinitive. Perfect infinitive shows prior action.',
                    translation: 'It is sufficiently well-known that an informer appeared'
                },
                'phrase-20': {
                    title: 'et Agrippinam auditis insidiis',
                    vocab: [
                        '<strong>et</strong> - and',
                        '<strong>Agrippinam</strong> - Agrippina (accusative)',
                        '<strong>auditis insidiis</strong> - when the plot had been heard (ablative absolute)'
                    ],
                    grammar: 'Accusative subject of continuing infinitive. Ablative absolute temporal.',
                    translation: 'and (it is well-known) that Agrippina, when the plot had been heard'
                },
                'phrase-21': {
                    title: 'an crederet ambiguam',
                    vocab: [
                        '<strong>an</strong> - whether',
                        '<strong>crederet</strong> - she should believe (imperfect subjunctive)',
                        '<strong>ambiguam</strong> - uncertain (accusative agreeing with Agrippinam)'
                    ],
                    grammar: 'Indirect question. "Ambiguam" is predicative accusative.',
                    translation: '(being) uncertain whether she should believe (it)'
                },
                'phrase-22': {
                    title: 'gestamine sellae Baias pervectam',
                    vocab: [
                        '<strong>gestamine</strong> - by carrying, by transport (ablative of means)',
                        '<strong>sellae</strong> - of a chair, of a sedan chair (genitive)',
                        '<strong>Baias</strong> - to Baiae (accusative of place to which)',
                        '<strong>pervectam</strong> - having been carried (perfect participle, accusative)'
                    ],
                    grammar: 'Perfect participle agreeing with "Agrippinam". Ablative of means.',
                    translation: 'was carried to Baiae by means of a sedan chair'
                },
                'phrase-23': {
                    title: 'ibi blandimentum sublevavit metum',
                    vocab: [
                        '<strong>ibi</strong> - there',
                        '<strong>blandimentum</strong> - flattery, cajolery (nominative)',
                        '<strong>sublevavit</strong> - alleviated, relieved (perfect, 3rd sing.)',
                        '<strong>metum</strong> - fear (accusative)'
                    ],
                    grammar: 'Perfect tense marks completed action. Direct object "metum".',
                    translation: 'There flattery alleviated (her) fear'
                },
                'phrase-24': {
                    title: 'comiter excepta superque ipsum conlocata',
                    vocab: [
                        '<strong>comiter</strong> - graciously, courteously (adverb)',
                        '<strong>excepta</strong> - having been received (perfect participle)',
                        '<strong>super</strong> - above (preposition)',
                        '<strong>-que</strong> - and',
                        '<strong>ipsum</strong> - himself (accusative)',
                        '<strong>conlocata</strong> - having been placed (perfect participle)'
                    ],
                    grammar: 'Perfect participles with implied "erat". "Super ipsum" = seating position.',
                    translation: '(she was) graciously received and placed above (Nero) himself'
                },
                'phrase-25': {
                    title: 'iam pluribus sermonibus modo familiaritate iuvenili Nero',
                    vocab: [
                        '<strong>iam</strong> - now',
                        '<strong>pluribus sermonibus</strong> - with many conversations (ablative)',
                        '<strong>modo</strong> - now, at one moment',
                        '<strong>familiaritate iuvenili</strong> - with youthful familiarity (ablative of manner)',
                        '<strong>Nero</strong> - Nero (nominative)'
                    ],
                    grammar: 'Ablatives of manner. "Modo" begins correlative with "rursus".',
                    translation: 'Now with many conversations, at one moment with youthful familiarity, Nero'
                },
                'phrase-26': {
                    title: 'et rursus adductus',
                    vocab: [
                        '<strong>et</strong> - and',
                        '<strong>rursus</strong> - again, on the other hand',
                        '<strong>adductus</strong> - stern, serious (perfect participle used as adjective)'
                    ],
                    grammar: 'Perfect participle as predicative adjective. Correlative with "modo".',
                    translation: 'and then again (being) stern'
                },
                'phrase-27': {
                    title: 'quasi seria consociaret',
                    vocab: [
                        '<strong>quasi</strong> - as if',
                        '<strong>seria</strong> - serious matters (neuter plural accusative)',
                        '<strong>consociaret</strong> - he was sharing (imperfect subjunctive)'
                    ],
                    grammar: 'Comparative clause with subjunctive expressing pretence.',
                    translation: 'as if he was sharing serious matters'
                },
                'phrase-28': {
                    title: 'tracto in longum convictu',
                    vocab: [
                        '<strong>tracto</strong> - having been dragged out (perfect participle)',
                        '<strong>in longum</strong> - into length, for a long time',
                        '<strong>convictu</strong> - feast, banquet (ablative absolute)'
                    ],
                    grammar: 'Ablative absolute showing temporal circumstance.',
                    translation: 'when the banquet had been dragged out for a long time'
                },
                'phrase-29': {
                    title: 'prosequitur abeuntem',
                    vocab: [
                        '<strong>prosequitur</strong> - he escorts (present, 3rd sing.)',
                        '<strong>abeuntem</strong> - (her) departing (present participle, accusative)'
                    ],
                    grammar: 'Historic present. Present participle as substantive.',
                    translation: 'he escorts (her) departing'
                },
                'phrase-30': {
                    title: 'artius oculis et pectori haerens, sive explenda simulatione, seu periturae matris supremus aspectus quamvis ferum animum retinebat',
                    vocab: [
                        '<strong>artius</strong> - more closely (comparative adverb)',
                        '<strong>oculis et pectori</strong> - to (her) eyes and breast (dative)',
                        '<strong>haerens</strong> - clinging (present participle)',
                        '<strong>sive...seu</strong> - whether...or',
                        '<strong>explenda simulatione</strong> - because pretence needed completing (gerundive ablative)',
                        '<strong>periturae matris</strong> - of (his) doomed mother (future participle)',
                        '<strong>supremus aspectus</strong> - last sight (nominative)',
                        '<strong>quamvis ferum animum</strong> - however savage (his) spirit (accusative)',
                        '<strong>retinebat</strong> - was holding back (imperfect)'
                    ],
                    grammar: 'Alternative explanations with "sive...seu". Gerundive of obligation. Future participle shows destiny.',
                    translation: 'clinging more closely to (her) eyes and breast, whether because the pretence needed to be completed, or the last sight of (his) doomed mother was holding back (his) spirit, however savage'
                }
            },

            style: {
                'style-1': {
                    title: 'Personification',
                    device: 'Personification: "placuit sollertia" (ingenuity pleased/was decided upon)',
                    effect: 'Making "sollertia" the grammatical subject gives the murder plot intellectual respectability - as if cleverness itself made the choice rather than Nero. This abstracts the crime into a technical problem requiring ingenuity, distancing moral responsibility through grammatical depersonalisation.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "Nero <em>sollertiam elegit</em>" (Nero chose ingenuity)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">placuit sollertia</span>" (ingenuity was decided upon)<br><br>By making "ingenuity" the subject, Tacitus removes Nero as active agent. The murder becomes an intellectual exercise, a clever solution - not a moral choice. Grammar obscures guilt.</div>'
                },
                'style-2': {
                    title: 'Ablative Absolute',
                    device: 'Ablative absolute: "tempore etiam iuta" (also helped by time/timing)',
                    effect: 'The passive participle makes timing seem like an independent agent assisting the plot. The ablative absolute presents circumstance as fate - the Quinquatrus festival wasn\'t chosen, it providentially "helped". This grammatical structure makes matricide feel like the convergence of circumstances rather than deliberate choice.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "Nero <em>tempus elegit</em>" (Nero chose the time - active planning)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">tempore etiam iuta</span>" (helped by time too)<br><br><strong>What ablative absolute does:</strong><br>‚Ä¢ Makes "time" an independent agent<br>‚Ä¢ Passive "iuta" = time helped (not: Nero used time)<br>‚Ä¢ "Etiam" = timing was extra lucky bonus<br><br>Grammar transforms calculated planning into lucky circumstances. Matricide becomes fate, not choice.</div>'
                },
                'style-3': {
                    title: 'Specific Detail',
                    device: 'Specific cultural detail: "Quinquatruum festos dies" (the festival days of the Quinquatrus)',
                    effect: 'The precise religious reference makes the murder plot parasitic on sacred time. Tacitus shows how Nero weaponises piety - the five-day festival of Minerva becomes cover for matricide. The specificity makes the sacrilege concrete: these aren\'t generic celebrations but a named festival being corrupted.',
                    pattern: 'single'
                },
                'style-4': {
                    title: 'Frequentative Verb',
                    device: 'Frequentative verb: "dictitans" (repeatedly saying)',
                    effect: 'The frequentative form emphasises Nero\'s persistent performance - he doesn\'t say it once but keeps hammering the message. The repetition suggests anxiety (he protests too much) whilst also showing the elaborate groundwork needed for deception. The grammar enacts the exhausting maintenance of the lie.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "<em>dicens</em>" (saying - once)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">dictitans</span>" (repeatedly saying)<br><br><strong>What the grammar shows:</strong><br>‚Ä¢ <em>dico</em> ‚Üí <em>dictito</em> (frequentative/intensive form)<br>‚Ä¢ Not a single statement but persistent repetition<br>‚Ä¢ He keeps saying it, again and again<br><br>The verb form reveals Nero\'s anxiety - he has to keep selling the lie.</div>'
                },
                'style-5': {
                    title: 'Oxymoron',
                    device: 'Oxymoron: "rumorem reconciliationis" (rumour/report of reconciliation)',
                    effect: 'True reconciliation wouldn\'t need to be a "rumour" - the combination exposes the artificiality. "Rumor" suggests public gossip, spin, reputation management rather than genuine feeling. The phrase reveals that Nero is staging reconciliation as public performance, not experiencing it as private reality.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "<em>reconciliationem</em>" (reconciliation - genuine)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">rumorem</span> reconciliationis" (rumour of reconciliation)<br><br><strong>The contradiction:</strong><br>‚Ä¢ <em>reconciliatio</em> = private reality, genuine feeling<br>‚Ä¢ <em>rumor</em> = public gossip, manufactured story<br><br>Tacitus exposes that Nero is creating PR spin, not real relationship repair.</div>'
                },
                'style-6': {
                    title: 'Loaded Vocabulary',
                    device: 'Loaded vocabulary: "facili feminarum credulitate" (women\'s easy credulity)',
                    effect: 'Tacitus deploys Roman misogyny to characterise Agrippina\'s vulnerability whilst simultaneously indicting her. The genitive "feminarum" makes this supposedly universal feminine weakness rather than individual naivety. The phrase does double work: it explains her susceptibility whilst subtly blaming her for it - she should have known better than to fall for "feminine" weakness.',
                    pattern: 'single'
                },
                'style-7': {
                    title: 'Vivid Participle',
                    device: 'Vivid participle: "venientem dehinc obvius" (meeting her as she comes)',
                    effect: 'The present participle creates simultaneous action - we see both Agrippina approaching and Nero advancing. "Obvius" (going to meet) suggests eagerness, filial devotion. The grammar choreographs the scene cinematically: two figures converging on the shore, one innocent, one murderous.',
                    pattern: 'single'
                },
                'style-8': {
                    title: 'Sensory Detail',
                    device: 'Sensory detail: "manu et complexu" (with hand and embrace)',
                    effect: 'The concrete body parts make the deception physically intimate. "Manus" (hand) suggests the formal greeting of equals, "complexus" (embrace) suggests affectionate reunion. These specific gestures create visceral horror - Nero\'s murdering hands literally touch his mother\'s body in false affection.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">manu</span> et <span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">complexu</span><br><br>Two parallel ablatives create balanced structure emphasising the physical gestures.</div>'
                },
                'style-9': {
                    title: 'Geographic Specificity',
                    device: 'Geographic specificity: "Baulos" (to Bauli)',
                    effect: 'The precise place name has ominous weight - this specific villa becomes the scene of crime. Unlike the earlier list of locations (gardens, Tusculum, Antium) where Agrippina might escape, Bauli is where Nero leads her. The geographic precision marks this as the killing ground, the end of the journey.',
                    pattern: 'single'
                },
                'style-10': {
                    title: 'Comparative',
                    device: 'Comparative adjective: "ornatior" (more elaborate/ornate)',
                    effect: 'The comparative invites comparison - more elaborate than what? Than Agrippina\'s normal transport, creating the illusion of honour. But "ornatior" can also mean "more deceptively adorned" - the extra decoration conceals the collapsible mechanism. The ambiguity makes beauty sinister.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "navis <em>ornata</em>" (an ornate ship - simple positive)<br>‚úÖ Tacitus: "navis <span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">ornatior</span>" (MORE ornate ship)<br><br><strong>The comparison creates suspicion:</strong><br>‚Ä¢ More ornate than WHAT? (Her usual trireme)<br>‚Ä¢ WHY more ornate? (Supposedly honour...)<br>‚Ä¢ TOO ornate? (The decoration hides the trap)<br><br>The comparative forces readers to ask questions Agrippina should have asked.</div>'
                },
                'style-11': {
                    title: 'Irony',
                    device: 'Ironic comparison: "tamquam...daretur" (as if...was being given)',
                    effect: 'The subjunctive after "tamquam" signals false pretence - this isn\'t genuine honour but performance of honour. The grammar exposes the gap between appearance (honour) and reality (murder weapon). The passive "daretur" further obscures agency - honours are "being given" by no one in particular.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "honori matris <em>dabatur</em>" (was being given - real honour)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">tamquam</span>...honori matris <span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">daretur</span>" (as if being given)<br><br><strong>What the subjunctive reveals:</strong><br>‚Ä¢ "Tamquam" + subjunctive = false appearance<br>‚Ä¢ Reality: murder weapon<br>‚Ä¢ Pretence: filial honour<br><br>Grammar itself calls out the lie - "as if" tells us this is performance, not reality.</div>'
                },
                'style-12': {
                    title: 'Personification',
                    device: 'Personification: "ut occultando facinori nox adhiberetur" (so that night might be used for hiding the crime)',
                    effect: 'Making "nox" the grammatical subject personifies darkness as co-conspirator. The gerund "occultando" (for hiding) reduces murder to logistics. The passive "adhiberetur" (might be used) treats night as a tool, making even natural phenomena complicit in the crime. The purpose clause makes moral horror into practical planning.',
                    pattern: 'single'
                },
                'style-13': {
                    title: 'Impersonal Construction',
                    device: 'Impersonal verb: "satis constitit" (it is sufficiently established/well-known)',
                    effect: 'The impersonal construction appeals to widespread knowledge without naming sources. "Satis" (sufficiently) suggests this is beyond reasonable doubt. The perfect tense makes it established fact. Tacitus positions himself as recorder of accepted truth rather than gossip-monger, whilst introducing the dramatic irony that Agrippina was warned.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "<em>quidam narrat</em>" (someone says - specific source)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">satis constitit</span>" (it is well-established)<br><br><strong>What the grammar achieves:</strong><br>‚Ä¢ No named subject = universal knowledge<br>‚Ä¢ "Constitit" (perfect) = firmly established fact<br>‚Ä¢ "Satis" = beyond reasonable doubt<br><br>Tacitus claims authority without citing sources. The grammar says "everybody knows this."</div>'
                },
                'style-14': {
                    title: 'Indirect Question',
                    device: 'Indirect question: "an crederet ambiguam" (uncertain whether to believe)',
                    effect: 'The subjunctive in indirect question shows genuine uncertainty - we\'re inside Agrippina\'s hesitation. "Ambiguam" (uncertain, wavering) reveals her psychological state: warned but wanting to believe in reconciliation. The grammar enacts her fatal indecision - the question remains unresolved as she proceeds to her death.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "<em>non credidit</em>" (she didn\'t believe - resolved)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">an crederet ambiguam</span>" (uncertain whether to believe)<br><br><strong>What the grammar reveals:</strong><br>‚Ä¢ Indirect question = unresolved internal debate<br>‚Ä¢ Subjunctive "crederet" = possibility, not fact<br>‚Ä¢ "Ambiguam" = she\'s stuck, wavering<br><br>We\'re inside her mind watching her fatal hesitation. The question stays open - she goes anyway.</div>'
                },
                'style-15': {
                    title: 'Dramatic Irony',
                    device: 'Dramatic irony: "comiter excepta superque ipsum conlocata" (graciously received and placed above him)',
                    effect: 'The elaborate courtesy ("comiter" = graciously, "super ipsum" = above Nero himself at table) makes the hospitality meticulously correct. The perfect participles present these as accomplished facts - she was received, she was honoured. The dramatic irony is crushing: every honour is prelude to murder. The seating arrangement (above = place of honour) makes the betrayal worse.',
                    pattern: 'single'
                },
                'style-16': {
                    title: 'Polysyndeton',
                    device: 'Polysyndeton: "manu et complexu...ducitque" (with hand and...and escorts)',
                    effect: 'The repeated "et/-que" conjunctions accumulate the gestures of false affection. Each action is separately emphasised through the connectives, building the performance of filial devotion. The polysyndeton makes the deception feel laboured, deliberate, staged.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br>manu <span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">et</span> complexu...<br>ducit<span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">que</span><br><br>Multiple conjunctions pile up actions instead of streamlining them.</div>'
                },
                'style-17': {
                    title: 'Parenthesis',
                    device: 'Parenthesis: "(nam Antio adventabat)" (for she was coming from Antium)',
                    effect: 'The parenthetical aside provides geographic context whilst breaking narrative flow. It emphasises Agrippina\'s journey - she\'s travelling from safety to danger. The interruption creates a pause, slowing the moment of their meeting to heighten dramatic tension.',
                    pattern: 'single'
                },
                'style-18': {
                    title: 'Variatio',
                    device: 'Variatio: "modo...et rursus...quasi" (now...and again...as if)',
                    effect: 'The varied conjunctions and adverbs create shifting, unstable tone. Nero oscillates between youthful warmth and stern seriousness, light conversation and grave consultation. The variatio in syntax mirrors his performed emotional range, showing the manipulation through grammatical instability.',
                    pattern: 'abc',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">modo</span> familiaritate iuvenili<br><span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">et rursus</span> adductus<br><span style="background: rgba(34, 197, 94, 0.4); padding: 2px 6px; border-radius: 3px;">quasi</span> seria consociaret<br><br>Three different markers create constantly shifting emotional tone.</div>'
                },
                'style-19': {
                    title: 'Alternatives',
                    device: 'Alternative explanations: "sive...seu" (whether...or)',
                    effect: 'Tacitus refuses to resolve the ambiguity of Nero\'s final embrace. Was it completing the performance or genuine last emotion? The paired alternatives hold both possibilities in tension, making the moment psychologically complex. The reader must live with the uncertainty, as perhaps Nero himself did.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">sive</span> explenda simulatione<br><span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">seu</span> periturae matris supremus aspectus<br><br>Balanced alternatives leave the motivation deliberately ambiguous.</div>'
                },
                'style-20': {
                    title: 'Emphatic Vocabulary',
                    device: 'Emphatic vocabulary: "artius...supremus...quamvis ferum" (more closely...last...however savage)',
                    effect: 'The intensifying words pile up: tighter embrace, final sight, savage spirit. "Artius" (more closely) suggests almost desperate clinging; "supremus" (last) carries fatal weight; "quamvis ferum" (however savage) acknowledges Nero\'s brutal nature. The emphatic vocabulary creates emotional crescendo at the moment of parting.',
                    pattern: 'aaa',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">artius</span> oculis et pectori haerens<br>periturae matris <span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">supremus</span> aspectus<br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">quamvis ferum</span> animum<br><br>Three intensifiers (closer, last, however savage) build emotional crescendo.</div>'
                },
                'style-21': {
                    title: 'Repetition',
                    device: 'Repetition: "Baias...Baias" (at Baiae...to Baiae)',
                    effect: 'The repeated place name creates a sense of destination and inevitability. Baiae appears first as the setting for Nero\'s festival, then as Agrippina\'s arrival point. The repetition transforms it from neutral location into the focal point of murder, the name itself becoming ominous through recurrence.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br>apud <span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">Baias</span> frequentabat<br>...<br>gestamine sellae <span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">Baias</span> pervectam<br><br>The place name recurs, transforming from setting to destination.</div>'
                },
                'style-22': {
                    title: 'Vivid Verb',
                    device: 'Vivid verb: "elicit" (he entices/lures out)',
                    effect: 'The verb "elicit" carries sinister connotations - it\'s not neutral "invites" but "lures out", suggesting predator and prey. The word choice makes Nero an active manipulator drawing his victim from safety. The present tense adds immediacy, making us watch the deception unfold in real time.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Neutral: "<em>invitat</em>" (he invites - polite, neutral)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">elicit</span>" (he lures out - sinister)<br><br><strong>What the verb choice reveals:</strong><br>‚Ä¢ <em>invito</em> = invite (neutral hospitality)<br>‚Ä¢ <em>elicio</em> = draw out, lure (predatory)<br>‚Ä¢ Suggests trap, bait, victim<br><br>One word transforms invitation into hunting metaphor - Agrippina is prey being drawn from safety.</div>'
                },
                'style-23': {
                    title: 'Alliteration',
                    device: 'Alliteration: nasal "n" sounds in "ferendas...iracundias...placandum...animum" (to be endured...angry feelings...to be appeased...spirit)',
                    effect: 'The repeated nasal consonants create a droning, insistent sound pattern. This phonetic persistence mirrors Nero\'s repetitive persuasion ("dictitans" - repeatedly saying). The sound reinforces the meaning: he\'s hammering home the same message over and over, wearing down resistance through relentless repetition.',
                    pattern: 'aaa',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Sound pattern:</strong><br>fere<span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px; text-decoration: underline;">n</span>das...<br>iracu<span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px; text-decoration: underline;">n</span>dias...<br>placa<span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px; text-decoration: underline;">n</span>dum a<span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px; text-decoration: underline;">n</span>imum<br><br>Repeated nasal "n" creates droning, insistent sound.</div>'
                },
                'style-24': {
                    title: 'Sound Pattern',
                    device: 'Sound pattern: "-um" endings in "Misenum...Baianum" (Misenum...Baian)',
                    effect: 'The matching accusative endings create rhythmic parallelism between the two geographic markers. This phonetic pairing emphasises the villa\'s precise location "between" these points. The sound pattern makes the description feel measured, exact - we can almost trace the coastline through the matching syllables.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Sound pattern:</strong><br>Misen<span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">um</span> inter et<br>Baian<span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">um</span> lacum<br><br>Matching accusative endings create rhythmic parallelism.</div>'
                },
                'style-25': {
                    title: 'Parallelism',
                    device: 'Parallelism: "triremi...classiariorum remigio" (in a trireme...with marines\' rowing)',
                    effect: 'The two ablatives create parallel structure emphasising Agrippina\'s accustomed grandeur. "Triremi" (warship) and "classiariorum remigio" (military rowers) stress her imperial status. The parallelism makes the contrast with the deceptive "ornatior" ship more pointed - she deserves military dignity, she\'s given ornamental death-trap.',
                    pattern: 'ab',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Visual pattern:</strong><br><span style="background: rgba(59, 130, 246, 0.4); padding: 2px 6px; border-radius: 3px;">triremi</span> et<br><span style="background: rgba(239, 68, 68, 0.4); padding: 2px 6px; border-radius: 3px;">classiariorum remigio</span> vehi<br><br>Parallel ablatives emphasise her accustomed imperial dignity.</div>'
                },
                'style-26': {
                    title: 'Loaded Vocabulary',
                    device: 'Loaded vocabulary: "epulas" (banquet, feast)',
                    effect: 'The word "epulas" carries connotations of elaborate, celebratory feasting - not just a meal but a special occasion. This makes the hospitality seem more lavish, the pretence more complete. The grand vocabulary masks the sinister purpose: this isn\'t dinner, it\'s the last supper.',
                    pattern: 'single'
                },
                'style-27': {
                    title: 'Emphatic Vocabulary',
                    device: 'Emphatic vocabulary: "proditorem" (informer/betrayer)',
                    effect: 'The word "proditor" is heavily loaded - it means traitor, betrayer, one who reveals secrets. The vocabulary creates ambiguity: is this person betraying Nero by warning Agrippina, or betraying Agrippina by being a plant? The emphatic word choice highlights the atmosphere of universal treachery.',
                    pattern: 'single'
                },
                'style-28': {
                    title: 'Abstract Noun',
                    device: 'Abstract noun: "blandimentum" (flattery/cajolery)',
                    effect: 'Making flattery the grammatical subject personifies deception as active agent. It\'s not "Nero flattered her" but "flattery alleviated fear" - as if sweet words themselves have power independent of the speaker. The abstraction distances Nero from his manipulation whilst making the deception feel pervasive, atmospheric.',
                    pattern: 'single',
                    visual: '<div style="margin-top: 0.75rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 0.85rem;"><strong>Why this matters:</strong><br><br>‚ùå Normal: "Nero <em>eam blandiendo sublevavit</em>" (Nero flattered and relieved her - Nero acts)<br>‚úÖ Tacitus: "<span style="background: rgba(234, 179, 8, 0.4); padding: 2px 6px; border-radius: 3px;">blandimentum</span> sublevavit metum" (flattery relieved fear)<br><br><strong>What abstraction achieves:</strong><br>‚Ä¢ Flattery becomes independent agent<br>‚Ä¢ Nero disappears from sentence<br>‚Ä¢ Deception feels atmospheric, not personal<br><br>Grammar removes Nero as subject. Manipulation happens, but who\'s responsible?</div>'
                }
            }
        };

        let currentAnalysis = null;
        let currentMode = 'grammar';
        let currentView = 'objectives';
        let currentStyleId = null;

        document.addEventListener('DOMContentLoaded', function() {
            loadLesson();
        });

        function loadLesson() {
            const latinTextEl = document.getElementById('latinText');
            latinTextEl.innerHTML = lessonData.latinText;
        }

        function showView(view) {
            currentView = view;
            
            if (event && event.currentTarget) {
                document.querySelectorAll('.sidebar .nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                event.currentTarget.classList.add('active');
            }

            const objectivesCard = document.getElementById('objectivesCard');
            const textCard = document.getElementById('textCard');
            const panelTitle = document.getElementById('panelTitle');
            const analysisPanel = document.getElementById('analysisPanel');

            if (view === 'objectives') {
                objectivesCard.style.display = 'block';
                textCard.style.display = 'none';
                panelTitle.textContent = 'Getting Started';
                analysisPanel.innerHTML = '<div class="default-message">Begin by reviewing the learning intentions, then move to the Read section to explore the Latin text</div>';
            } else if (view === 'text') {
                objectivesCard.style.display = 'none';
                textCard.style.display = 'block';
                panelTitle.textContent = 'Analysis';
                analysisPanel.innerHTML = '<div class="default-message" id="defaultMessage">Click any coloured phrase to see vocabulary and grammar</div>';
                
                for (const [id, data] of Object.entries(lessonData.grammar)) {
                    const card = createGrammarCard(id, data);
                    analysisPanel.appendChild(card);
                }
                for (const [id, data] of Object.entries(lessonData.style)) {
                    const card = createStyleCard(id, data);
                    analysisPanel.appendChild(card);
                }
            }

            currentAnalysis = null;
            currentStyleId = null;
        }

        function setMode(mode) {
            currentMode = mode;
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            const latinText = document.getElementById('latinText');
            if (mode === 'style') {
                latinText.classList.add('mode-style');
            } else {
                latinText.classList.remove('mode-style');
            }
            
            // Clear all active highlights
            clearAllHighlights();
            
            if (currentAnalysis) {
                currentAnalysis.classList.remove('active');
                currentAnalysis = null;
            }
            currentStyleId = null;
            const defaultMsg = document.getElementById('defaultMessage');
            if (defaultMsg) defaultMsg.style.display = 'block';
        }

        function clearAllHighlights() {
            document.querySelectorAll('.highlight-style').forEach(el => {
                el.classList.remove('active-a', 'active-b', 'active-c', 'active-d', 'active-single');
            });
        }

        function showAnalysis(phraseId) {
            if (currentView !== 'text') return;
            
            if (phraseId.startsWith('style') && currentMode !== 'style') {
                return;
            }
            if (phraseId.startsWith('phrase') && currentMode === 'style') {
                return;
            }
            
            const defaultMsg = document.getElementById('defaultMessage');
            if (defaultMsg) defaultMsg.style.display = 'none';
            
            if (currentAnalysis) {
                currentAnalysis.classList.remove('active');
            }
            
            const card = document.getElementById(phraseId);
            if (card) {
                card.classList.add('active');
                currentAnalysis = card;
                card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        function showStyleAnalysis(styleId) {
            if (currentMode !== 'style') return;
            
            // Clear previous highlights if different style
            if (currentStyleId !== styleId) {
                clearAllHighlights();
                currentStyleId = styleId;
            }
            
            // Highlight elements for this style
            const elements = document.querySelectorAll(`[data-style="${styleId}"]`);
            const styleData = lessonData.style[styleId];
            
            if (styleData && styleData.pattern) {
                const pattern = styleData.pattern;
                
                if (pattern === 'single') {
                    elements.forEach(el => el.classList.add('active-single'));
                } else if (pattern === 'a') {
                    elements.forEach(el => el.classList.add('active-a'));
                } else if (pattern === 'aaa') {
                    // All three get the same colour
                    elements.forEach(el => el.classList.add('active-a'));
                } else if (pattern === 'ab') {
                    elements.forEach((el, index) => {
                        el.classList.add(index % 2 === 0 ? 'active-a' : 'active-b');
                    });
                } else if (pattern === 'abc') {
                    elements.forEach((el, index) => {
                        const classes = ['active-a', 'active-b', 'active-c'];
                        el.classList.add(classes[index % 3] || 'active-a');
                    });
                }
            }
            
            showAnalysis(styleId);
        }

        function createGrammarCard(id, data) {
            const card = document.createElement('div');
            card.className = 'analysis-card';
            card.id = id;
            
            let vocabHTML = data.vocab.map(v => `<p>‚Ä¢ ${v}</p>`).join('');
            
            card.innerHTML = `
                <div class="analysis-badge">Grammar & Vocabulary</div>
                <h4>${data.title}</h4>
                <div class="vocab-list">${vocabHTML}</div>
                <p><strong>Grammar:</strong> ${data.grammar}</p>
                <div class="translation-section">
                    <button class="reveal-translation-btn" onclick="revealTranslation('${id}')">Reveal Translation</button>
                    <div class="translation-text" id="${id}-translation">
                        <strong>Translation:</strong> "${data.translation}"
                    </div>
                </div>
            `;
            
            return card;
        }

        function revealTranslation(cardId) {
            const translationEl = document.getElementById(cardId + '-translation');
            const button = event.currentTarget;
            
            if (translationEl && !translationEl.classList.contains('visible')) {
                translationEl.classList.add('visible');
                button.textContent = '‚úì Translation Revealed';
                button.classList.add('revealed');
            }
        }

        function createStyleCard(id, data) {
            const card = document.createElement('div');
            card.className = 'analysis-card';
            card.id = id;
            
            const visualHTML = data.visual ? data.visual : '';
            
            card.innerHTML = `
                <div class="analysis-badge">Literary Device</div>
                <h4>${data.title}</h4>
                <p><strong>Device:</strong> ${data.device}</p>
                <p><strong>Effect:</strong> ${data.effect}</p>
                ${visualHTML}
            `;
            
            return card;
        }

        function toggleFullTranslation() {
            const existing = document.getElementById('fullTranslationBox');
            if (existing) {
                existing.remove();
                event.currentTarget.textContent = 'Show Translation';
                return;
            }
            
            const translationBox = document.createElement('div');
            translationBox.id = 'fullTranslationBox';
            translationBox.style.cssText = 'background: rgba(230, 240, 255, 0.8); border-radius: 12px; padding: 1.5rem; margin-top: 1rem; border: 1px solid rgba(0, 102, 255, 0.2);';
            translationBox.innerHTML = `
                <h4 style="font-size: 0.9rem; font-weight: 600; color: #0066ff; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.75rem;">Full Translation</h4>
                <p style="font-size: 1rem; line-height: 1.8; color: #333;">${lessonData.fullTranslation}</p>
            `;
            
            document.querySelector('.btn-group').insertAdjacentElement('beforebegin', translationBox);
            event.currentTarget.textContent = 'Hide Translation';
        }

        function resetView() {
            if (currentAnalysis) {
                currentAnalysis.classList.remove('active');
                currentAnalysis = null;
            }
            
            clearAllHighlights();
            currentStyleId = null;
            
            const defaultMsg = document.getElementById('defaultMessage');
            if (defaultMsg) defaultMsg.style.display = 'block';
            
            const fullTransBox = document.getElementById('fullTranslationBox');
            if (fullTransBox) fullTransBox.remove();
        }
    </script>
</body>
</html>
