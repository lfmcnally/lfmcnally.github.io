<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Otium - Poem 50 (Lines 1-10)</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #ffffff;
            color: #333;
            padding: 25px 45px;
            min-height: 100vh;
            margin: 0;
            font-size: 22px;
        }
        
        .header {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .header-left {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #0066ff 0%, #4d94ff 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.5rem;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            text-decoration: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            margin-top: 2px;
        }
        
        .logo:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.3);
        }
        
        .title-area {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        h1 {
            color: #222;
            margin: 0;
            font-size: 1.6em;
            font-weight: 600;
        }
        
        .subtitle {
            font-size: 1em;
            color: #666;
            margin: 0;
        }
        
        /* Compact controls */
        .controls-area {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: 4px;
        }
        
        .controls {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
        }
        
        .controls button {
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(0, 102, 255, 0.08);
            color: #0066ff;
            flex: 1;
            text-align: center;
        }
        
        .controls button:hover {
            background: rgba(0, 102, 255, 0.15);
            transform: translateY(-1px);
        }
        
        #showAllBtn {
            background: #0066ff;
            color: white;
        }
        
        #showAllBtn:hover {
            background: #0052cc;
        }
        
        #hideAllBtn {
            background: rgba(0, 102, 255, 0.08);
            color: #0066ff;
        }
        
        #toggleColoursBtn {
            background: rgba(0, 102, 255, 0.08);
            color: #0066ff;
        }
        
        #toggleStyleBtn {
            background: rgba(0, 102, 255, 0.08);
            color: #0066ff;
        }
        
        body.style-mode #toggleStyleBtn {
            background: #0066ff;
            color: white;
        }
        
        /* Key - compact squares in header */
        .key {
            display: flex;
            gap: 6px;
        }
        
        .key-item {
            padding: 0.6rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            color: #333;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s ease;
            text-align: center;
            border: none;
            flex: 1;
        }
        
        .key-item:hover {
            transform: translateY(-1px);
            filter: brightness(0.95);
        }
        
        .key-item.active {
            outline: 2px solid #333;
            outline-offset: 1px;
        }
        
        /* Main content area */
        .translation-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
        }
        
        .column-header {
            font-size: 0.9em;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
            padding-left: 55px;
        }
        
        /* Each line row */
        .line-row {
            display: flex;
            align-items: flex-end;
            margin-bottom: 14px;
            white-space: nowrap;
        }
        
        .line-number {
            color: #0066ff;
            font-weight: bold;
            min-width: 45px;
            margin-right: 10px;
            font-size: 1.15em;
            align-self: flex-end;
            padding-bottom: 4px;
        }
        
        .words-container {
            display: flex;
            align-items: flex-end;
            gap: 3px;
        }
        
        /* Word group with number above */
        .word-group {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }
        
        .word-order {
            font-size: 0.65em;
            color: #888;
            margin-bottom: 4px;
            height: 1em;
            font-weight: 600;
        }
        
        .latin-word, .english-word {
            padding: 3px 7px;
            border-radius: 3px;
            font-size: 1em;
            transition: background-color 0.3s, opacity 0.3s;
            cursor: pointer;
        }
        
        .latin-word {
            background-color: transparent;
        }
        
        .english-word {
            opacity: 0;
        }
        
        .english-word.revealed {
            opacity: 1;
        }
        
        /* Colours */
        .subject .latin-word { background-color: #ffb3b3; }
        .english-word.subject { background-color: #ffb3b3; }
        
        .verb .latin-word { background-color: #b3e6ff; }
        .english-word.verb { background-color: #b3e6ff; }
        
        .object .latin-word { background-color: #b3ffcc; }
        .english-word.object { background-color: #b3ffcc; }
        
        .genitive .latin-word { background-color: #ffd9b3; }
        .english-word.genitive { background-color: #ffd9b3; }
        
        .dative .latin-word { background-color: #e6b3ff; }
        .english-word.dative { background-color: #e6b3ff; }
        
        .ablative .latin-word { background-color: #ffffb3; }
        .english-word.ablative { background-color: #ffffb3; }
        
        .preposition .latin-word { background-color: #ffb3e6; }
        .english-word.preposition { background-color: #ffb3e6; }
        
        .conjunction .latin-word { background-color: #d9ffb3; }
        .english-word.conjunction { background-color: #d9ffb3; }
        
        .adverb .latin-word { background-color: #ccb3ff; }
        .english-word.adverb { background-color: #ccb3ff; }
        
        .vocative .latin-word { background-color: #ffcbb3; }
        .english-word.vocative { background-color: #ffcbb3; }
        
        /* Highlighting */
        .subject.highlighted .latin-word { background-color: #ffb3b3 !important; }
        .english-word.subject.highlighted { background-color: #ffb3b3 !important; }
        .verb.highlighted .latin-word { background-color: #b3e6ff !important; }
        .english-word.verb.highlighted { background-color: #b3e6ff !important; }
        .object.highlighted .latin-word { background-color: #b3ffcc !important; }
        .english-word.object.highlighted { background-color: #b3ffcc !important; }
        .genitive.highlighted .latin-word { background-color: #ffd9b3 !important; }
        .english-word.genitive.highlighted { background-color: #ffd9b3 !important; }
        .dative.highlighted .latin-word { background-color: #e6b3ff !important; }
        .english-word.dative.highlighted { background-color: #e6b3ff !important; }
        .ablative.highlighted .latin-word { background-color: #ffffb3 !important; }
        .english-word.ablative.highlighted { background-color: #ffffb3 !important; }
        .preposition.highlighted .latin-word { background-color: #ffb3e6 !important; }
        .english-word.preposition.highlighted { background-color: #ffb3e6 !important; }
        .conjunction.highlighted .latin-word { background-color: #d9ffb3 !important; }
        .english-word.conjunction.highlighted { background-color: #d9ffb3 !important; }
        .adverb.highlighted .latin-word { background-color: #ccb3ff !important; }
        .english-word.adverb.highlighted { background-color: #ccb3ff !important; }
        .vocative.highlighted .latin-word { background-color: #ffcbb3 !important; }
        .english-word.vocative.highlighted { background-color: #ffcbb3 !important; }
        
        /* Hide colours mode */
        body.hide-colours .subject .latin-word,
        body.hide-colours .english-word.subject.revealed,
        body.hide-colours .verb .latin-word,
        body.hide-colours .english-word.verb.revealed,
        body.hide-colours .object .latin-word,
        body.hide-colours .english-word.object.revealed,
        body.hide-colours .genitive .latin-word,
        body.hide-colours .english-word.genitive.revealed,
        body.hide-colours .dative .latin-word,
        body.hide-colours .english-word.dative.revealed,
        body.hide-colours .ablative .latin-word,
        body.hide-colours .english-word.ablative.revealed,
        body.hide-colours .preposition .latin-word,
        body.hide-colours .english-word.preposition.revealed,
        body.hide-colours .conjunction .latin-word,
        body.hide-colours .english-word.conjunction.revealed,
        body.hide-colours .adverb .latin-word,
        body.hide-colours .english-word.adverb.revealed,
        body.hide-colours .vocative .latin-word,
        body.hide-colours .english-word.vocative.revealed {
            background-color: #e0e0e0;
        }
        
        /* Style Mode */
        .style-highlight {
            position: relative;
        }
        
        .style-highlight.active-style .latin-word {
            outline: 2px solid #333;
            outline-offset: 1px;
        }
        
        /* Style panel at bottom */
        .style-panel {
            display: none;
            background: rgba(0, 102, 255, 0.03);
            border-top: 2px solid rgba(0, 102, 255, 0.15);
            padding: 18px 24px;
            margin-top: 20px;
        }
        
        body.style-mode .style-panel {
            display: block;
        }
        
        .style-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .style-panel h3 {
            margin: 0;
            color: #0066ff;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .style-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .style-tag {
            padding: 8px 14px;
            background: white;
            border: 1px solid rgba(0, 102, 255, 0.25);
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #333;
        }
        
        .style-tag:hover {
            border-color: #0066ff;
            background: rgba(0, 102, 255, 0.05);
        }
        
        .style-tag.active {
            background: #0066ff;
            color: white;
            border-color: #0066ff;
        }
        
        .style-tag em {
            font-style: italic;
        }
        
        .style-analysis {
            display: none;
            padding: 16px 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid rgba(0, 102, 255, 0.15);
            margin-top: 10px;
        }
        
        .style-analysis.active {
            display: block;
        }
        
        .style-analysis-title {
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 6px;
            font-size: 1rem;
        }
        
        .style-analysis-lines {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .style-analysis-effect {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 12px;
        }
        
        .style-analysis-exam {
            font-size: 0.9rem;
            line-height: 1.5;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 6px;
            border-left: 3px solid #0066ff;
        }
        
        .word-group:hover .latin-word {
            filter: brightness(0.95);
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <div class="header-left">
                <a href="https://www.classicalia.co.uk" class="logo">C</a>
                <div class="title-area">
                    <h1>Otium — Poem 50 (Lines 1-10)</h1>
                    <p class="subtitle">Excited by a visit to Calvus, Catullus cannot sleep</p>
                </div>
            </div>
            <div class="controls-area">
                <div class="controls">
                    <button id="showAllBtn">Show All</button>
                    <button id="hideAllBtn">Hide All</button>
                    <button id="toggleColoursBtn">Hide Colours</button>
                    <button id="toggleStyleBtn">Style Notes</button>
                </div>
                <div class="key">
                    <div class="key-item" style="background-color: #ffb3b3;" data-category="subject">Subj.</div>
                    <div class="key-item" style="background-color: #b3ffcc;" data-category="object">Obj.</div>
                    <div class="key-item" style="background-color: #b3e6ff;" data-category="verb">Verb</div>
                    <div class="key-item" style="background-color: #ffd9b3;" data-category="genitive">Gen.</div>
                    <div class="key-item" style="background-color: #e6b3ff;" data-category="dative">Dat.</div>
                    <div class="key-item" style="background-color: #ffffb3;" data-category="ablative">Abl.</div>
                    <div class="key-item" style="background-color: #ffb3e6;" data-category="preposition">Prep.</div>
                    <div class="key-item" style="background-color: #d9ffb3;" data-category="conjunction">Conj.</div>
                    <div class="key-item" style="background-color: #ccb3ff;" data-category="adverb">Adv.</div>
                    <div class="key-item" style="background-color: #ffcbb3;" data-category="vocative">Voc.</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="translation-area">
        <!-- Latin Column -->
        <div class="latin-column">
            <div class="column-header">Latin</div>
            
            <!-- Line 1: hesterno, Licini, die otiosi -->
            <div class="line-row" data-line="1">
                <span class="line-number">1</span>
                <div class="words-container">
                    <span class="word-group ablative style-highlight" data-order="01-01" data-style-feature="hesterno"><span class="word-order">1*</span><span class="latin-word">hesternō,</span></span>
                    <span class="word-group vocative style-highlight" data-order="01-02" data-style-feature="licini"><span class="word-order">2</span><span class="latin-word">Licinī,</span></span>
                    <span class="word-group ablative style-highlight" data-order="01-01" data-style-feature="hesterno"><span class="word-order">1*</span><span class="latin-word">diē</span></span>
                    <span class="word-group subject style-highlight" data-order="01-03" data-style-feature="otiosi"><span class="word-order">3</span><span class="latin-word">ōtiōsī</span></span>
                </div>
            </div>
            
            <!-- Line 2: multum lusimus in meis tabellis -->
            <div class="line-row" data-line="2">
                <span class="line-number">2</span>
                <div class="words-container">
                    <span class="word-group adverb" data-order="02-05"><span class="word-order">5</span><span class="latin-word">multum</span></span>
                    <span class="word-group verb style-highlight" data-order="02-04" data-style-feature="lusimus"><span class="word-order">4</span><span class="latin-word">lūsimus</span></span>
                    <span class="word-group preposition" data-order="02-06"><span class="word-order">6</span><span class="latin-word">in</span></span>
                    <span class="word-group ablative" data-order="02-07"><span class="word-order">7</span><span class="latin-word">meīs</span></span>
                    <span class="word-group ablative style-highlight" data-order="02-08" data-style-feature="tabellis"><span class="word-order">8</span><span class="latin-word">tabellīs,</span></span>
                </div>
            </div>
            
            <!-- Line 3: ut convenerat esse delicatos; -->
            <div class="line-row" data-line="3">
                <span class="line-number">3</span>
                <div class="words-container">
                    <span class="word-group conjunction" data-order="03-09"><span class="word-order">9</span><span class="latin-word">ut</span></span>
                    <span class="word-group verb" data-order="03-10"><span class="word-order">10</span><span class="latin-word">convēnerat</span></span>
                    <span class="word-group verb" data-order="03-11"><span class="word-order">11</span><span class="latin-word">esse</span></span>
                    <span class="word-group object style-highlight" data-order="03-12" data-style-feature="delicatos"><span class="word-order">12</span><span class="latin-word">dēlicātōs;</span></span>
                </div>
            </div>
            
            <!-- Line 4: scribens versiculos uterque nostrum -->
            <div class="line-row" data-line="4">
                <span class="line-number">4</span>
                <div class="words-container">
                    <span class="word-group verb" data-order="04-03"><span class="word-order">3</span><span class="latin-word">scrībēns</span></span>
                    <span class="word-group object style-highlight" data-order="04-04" data-style-feature="versiculos"><span class="word-order">4</span><span class="latin-word">versiculōs</span></span>
                    <span class="word-group subject" data-order="04-01"><span class="word-order">1</span><span class="latin-word">uterque</span></span>
                    <span class="word-group genitive" data-order="04-02"><span class="word-order">2</span><span class="latin-word">nostrum</span></span>
                </div>
            </div>
            
            <!-- Line 5: ludebat numero modo hoc modo illoc -->
            <div class="line-row" data-line="5">
                <span class="line-number">5</span>
                <div class="words-container">
                    <span class="word-group verb" data-order="05-05"><span class="word-order">5</span><span class="latin-word">lūdēbat</span></span>
                    <span class="word-group ablative" data-order="05-08"><span class="word-order">8</span><span class="latin-word">numerō</span></span>
                    <span class="word-group adverb style-highlight" data-order="05-06" data-style-feature="modo"><span class="word-order">6</span><span class="latin-word">modo</span></span>
                    <span class="word-group ablative" data-order="05-07"><span class="word-order">7</span><span class="latin-word">hōc</span></span>
                    <span class="word-group adverb style-highlight" data-order="05-09" data-style-feature="modo"><span class="word-order">9</span><span class="latin-word">modo</span></span>
                    <span class="word-group ablative" data-order="05-10"><span class="word-order">10</span><span class="latin-word">illōc,</span></span>
                </div>
            </div>
            
            <!-- Line 6: reddens mutua per iocum atque vinum -->
            <div class="line-row" data-line="6">
                <span class="line-number">6</span>
                <div class="words-container">
                    <span class="word-group verb" data-order="06-11"><span class="word-order">11</span><span class="latin-word">reddēns</span></span>
                    <span class="word-group object" data-order="06-12"><span class="word-order">12</span><span class="latin-word">mūtua</span></span>
                    <span class="word-group preposition" data-order="06-13"><span class="word-order">13</span><span class="latin-word">per</span></span>
                    <span class="word-group object style-highlight" data-order="06-14" data-style-feature="iocum-vinum"><span class="word-order">14</span><span class="latin-word">iocum</span></span>
                    <span class="word-group conjunction" data-order="06-15"><span class="word-order">15</span><span class="latin-word">atque</span></span>
                    <span class="word-group object style-highlight" data-order="06-16" data-style-feature="iocum-vinum"><span class="word-order">16</span><span class="latin-word">vīnum.</span></span>
                </div>
            </div>
            
            <!-- Line 7: atque illinc abii tuo lepore -->
            <div class="line-row" data-line="7">
                <span class="line-number">7</span>
                <div class="words-container">
                    <span class="word-group conjunction" data-order="07-01"><span class="word-order">1</span><span class="latin-word">atque</span></span>
                    <span class="word-group adverb" data-order="07-03"><span class="word-order">3</span><span class="latin-word">illinc</span></span>
                    <span class="word-group verb" data-order="07-02"><span class="word-order">2</span><span class="latin-word">abiī</span></span>
                    <span class="word-group ablative" data-order="07-05"><span class="word-order">5</span><span class="latin-word">tuō</span></span>
                    <span class="word-group ablative style-highlight" data-order="07-06" data-style-feature="lepore"><span class="word-order">6</span><span class="latin-word">lepōre</span></span>
                </div>
            </div>
            
            <!-- Line 8: incensus, Licini, facetiisque -->
            <div class="line-row" data-line="8">
                <span class="line-number">8</span>
                <div class="words-container">
                    <span class="word-group verb style-highlight" data-order="07-04" data-style-feature="incensus"><span class="word-order">4</span><span class="latin-word">incēnsus,</span></span>
                    <span class="word-group vocative style-highlight" data-order="08-09" data-style-feature="licini"><span class="word-order">9</span><span class="latin-word">Licinī,</span></span>
                    <span class="word-group ablative style-highlight" data-order="08-08" data-style-feature="facetiis"><span class="word-order">8</span><span class="latin-word">facetiīs</span></span>
                    <span class="word-group conjunction" data-order="08-07"><span class="word-order">7</span><span class="latin-word">-que,</span></span>
                </div>
            </div>
            
            <!-- Line 9: ut nec me miserum cibus iuvaret -->
            <div class="line-row" data-line="9">
                <span class="line-number">9</span>
                <div class="words-container">
                    <span class="word-group conjunction" data-order="09-10"><span class="word-order">10</span><span class="latin-word">ut</span></span>
                    <span class="word-group conjunction" data-order="09-11"><span class="word-order">11</span><span class="latin-word">nec</span></span>
                    <span class="word-group object style-highlight" data-order="09-14" data-style-feature="chiasmus"><span class="word-order">14</span><span class="latin-word">mē</span></span>
                    <span class="word-group object style-highlight" data-order="09-15" data-style-feature="miserum chiasmus"><span class="word-order">15</span><span class="latin-word">miserum</span></span>
                    <span class="word-group subject style-highlight" data-order="09-12" data-style-feature="chiasmus"><span class="word-order">12</span><span class="latin-word">cibus</span></span>
                    <span class="word-group verb style-highlight" data-order="09-13" data-style-feature="chiasmus"><span class="word-order">13</span><span class="latin-word">iuvāret</span></span>
                </div>
            </div>
            
            <!-- Line 10: nec somnus tegeret quiete ocellos... -->
            <div class="line-row" data-line="10">
                <span class="line-number">10</span>
                <div class="words-container">
                    <span class="word-group conjunction" data-order="10-16"><span class="word-order">16</span><span class="latin-word">nec</span></span>
                    <span class="word-group subject style-highlight" data-order="10-17" data-style-feature="chiasmus"><span class="word-order">17</span><span class="latin-word">somnus</span></span>
                    <span class="word-group verb style-highlight" data-order="10-18" data-style-feature="chiasmus"><span class="word-order">18</span><span class="latin-word">tegeret</span></span>
                    <span class="word-group ablative" data-order="10-20"><span class="word-order">20</span><span class="latin-word">quiēte</span></span>
                    <span class="word-group object style-highlight" data-order="10-19" data-style-feature="ocellos chiasmus"><span class="word-order">19</span><span class="latin-word">ocellōs...</span></span>
                </div>
            </div>
        </div>
        
        <!-- English Column -->
        <div class="english-column">
            <div class="column-header">English</div>
            
            <!-- Line 1 English -->
            <div class="line-row" data-line="1">
                <span class="line-number">1</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="01-01">Yesterday,</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word vocative" data-order="01-02">Licinius,</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word subject" data-order="01-03">being at leisure,</span></span>
                </div>
            </div>
            
            <!-- Line 2 English -->
            <div class="line-row" data-line="2">
                <span class="line-number">2</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="02-04">we played</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word adverb" data-order="02-05">a lot</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word preposition" data-order="02-06">on</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="02-07">my</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="02-08">tablets,</span></span>
                </div>
            </div>
            
            <!-- Line 3 English -->
            <div class="line-row" data-line="3">
                <span class="line-number">3</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="03-09">as</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="03-10">it had suited us</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="03-11">to be</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="03-12">frivolous;</span></span>
                </div>
            </div>
            
            <!-- Line 4 English -->
            <div class="line-row" data-line="4">
                <span class="line-number">4</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word subject" data-order="04-01">each</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word genitive" data-order="04-02">of us</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="04-03">writing</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="04-04">trivial verses,</span></span>
                </div>
            </div>
            
            <!-- Line 5 English -->
            <div class="line-row" data-line="5">
                <span class="line-number">5</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="05-05">played</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word adverb" data-order="05-06">now</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="05-07">in this</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="05-08">metre,</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word adverb" data-order="05-09">now</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="05-10">in that,</span></span>
                </div>
            </div>
            
            <!-- Line 6 English -->
            <div class="line-row" data-line="6">
                <span class="line-number">6</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="06-11">exchanging</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="06-12">lines between us</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word preposition" data-order="06-13">amid</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="06-14">jokes</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="06-15">and</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="06-16">wine.</span></span>
                </div>
            </div>
            
            <!-- Line 7 English -->
            <div class="line-row" data-line="7">
                <span class="line-number">7</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="07-01">And indeed,</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="07-02">I went away</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word adverb" data-order="07-03">from there,</span></span>
                </div>
            </div>
            
            <!-- Line 8 English -->
            <div class="line-row" data-line="8">
                <span class="line-number">8</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="07-04">fired</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="07-05">by your</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="07-06">charm</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="08-07">and</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="08-08">witticisms,</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word vocative" data-order="08-09">Licinius,</span></span>
                </div>
            </div>
            
            <!-- Line 9 English -->
            <div class="line-row" data-line="9">
                <span class="line-number">9</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="09-10">so that</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="09-11">neither</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word subject" data-order="09-12">food</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="09-13">helped</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="09-14">me</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="09-15">in my wretchedness,</span></span>
                </div>
            </div>
            
            <!-- Line 10 English -->
            <div class="line-row" data-line="10">
                <span class="line-number">10</span>
                <div class="words-container">
                    <span class="word-group"><span class="word-order"></span><span class="english-word conjunction" data-order="10-16">nor</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word subject" data-order="10-17">sleep</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word verb" data-order="10-18">covered</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word object" data-order="10-19">my dear eyes</span></span>
                    <span class="word-group"><span class="word-order"></span><span class="english-word ablative" data-order="10-20">with rest...</span></span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Style Panel -->
    <div class="style-panel">
        <div class="style-panel-header">
            <h3>Stylistic Features</h3>
        </div>
        <div class="style-list">
            <span class="style-tag" data-feature="hesterno">Temporal Framing — <em>hesternō... diē</em></span>
            <span class="style-tag" data-feature="licini">Vocative Address — <em>Licinī</em> (Calvus)</span>
            <span class="style-tag" data-feature="otiosi">Key Theme — <em>ōtiōsī</em></span>
            <span class="style-tag" data-feature="lusimus">Ludic Vocabulary — <em>lūsimus</em></span>
            <span class="style-tag" data-feature="tabellis">Metonymy — <em>tabellīs</em></span>
            <span class="style-tag" data-feature="delicatos">Neoteric Term — <em>dēlicātōs</em></span>
            <span class="style-tag" data-feature="versiculos">Diminutive — <em>versiculōs</em></span>
            <span class="style-tag" data-feature="modo">Anaphora — <em>modo... modo</em></span>
            <span class="style-tag" data-feature="iocum-vinum">Hendiadys — <em>per iocum atque vīnum</em></span>
            <span class="style-tag" data-feature="lepore">Neoteric Term — <em>lepōre</em></span>
            <span class="style-tag" data-feature="incensus">Erotic Metaphor — <em>incēnsus</em></span>
            <span class="style-tag" data-feature="facetiis">Neoteric Term — <em>facetiīs</em></span>
            <span class="style-tag" data-feature="miserum">Dramatic Self-Pity — <em>miserum</em></span>
            <span class="style-tag" data-feature="ocellos">Diminutive — <em>ocellōs</em></span>
            <span class="style-tag" data-feature="chiasmus">Chiasmus — <em>nec... nec</em> clauses</span>
        </div>
        
        <div class="style-analysis" id="analysis-hesterno">
            <div class="style-analysis-title">Temporal Framing — hesternō... diē</div>
            <div class="style-analysis-lines">Line 1</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "Yesterday" — the poem plunges us straight into a specific moment. This isn't some vague poetic musing; Catullus wants you to know exactly when this happened. The framing word <em>hesternō</em> wraps around the vocative <em>Licinī</em> to embrace <em>diē</em>, creating an elegant hyperbaton. It's like saying "on yesterday, Licinius, day" — the time-reference sandwiches the friend's name, binding them together.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The hyperbaton of <em>hesternō... diē</em> ('yesterday'), framing the vocative <em>Licinī</em>, immediately establishes temporal specificity while syntactically binding the addressee to the memory of their shared leisure."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-licini">
            <div class="style-analysis-title">Vocative Address — Licinī (Calvus)</div>
            <div class="style-analysis-lines">Lines 1, 8</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> Catullus names his friend twice — once at the start, once in the middle when emotions are heating up. <em>Licinī</em> is the vocative of "Licinius," but we usually call him <strong>Calvus</strong> — his cognomen (nickname), meaning "Bald." His full name was Gaius Licinius Macer Calvus, a famous orator and poet, one of Catullus's closest friends. Romans often used family names (<em>nōmina</em>) in direct address, so "Licinius" in the Latin, "Calvus" when we talk about him. The repeated vocative creates intimacy — we're overhearing a private address. It's like those texts you send to a friend where you keep using their name because you're so fond of them.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The repeated vocative <em>Licinī</em> (lines 1, 8), addressing the poet Calvus by his family name, creates intimacy and emotional intensity. The second instance coincides with the shift from playful reminiscence to burning passion, marking Calvus as the object of Catullus's heightened feelings."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-otiosi">
            <div class="style-analysis-title">Key Theme — ōtiōsī</div>
            <div class="style-analysis-lines">Line 1</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> <em>Ōtium</em> ("leisure") is the title concept! For Romans, <em>ōtium</em> was the opposite of <em>negōtium</em> (business, public duty). Here, two friends being <em>ōtiōsī</em> — "at leisure" — isn't laziness; it's the productive idleness that allows poetry to happen. This is the neoteric lifestyle: rejecting politics for the pursuit of refined pleasure and artistic play.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The programmatic <em>ōtiōsī</em> ('being at leisure') signals the neoteric rejection of <em>negōtium</em> (public business) in favour of refined literary pursuits. This cultivated leisure is the precondition for the poetic play that follows."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-lusimus">
            <div class="style-analysis-title">Ludic Vocabulary — lūsimus</div>
            <div class="style-analysis-lines">Line 2</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "We played" — but wait, <em>lūdere</em> means both "to play" and "to write poetry" in Catullan vocabulary. It's a neoteric buzzword. Poetry isn't serious work (<em>labor</em>); it's play (<em>lūdus</em>). The verb returns in line 5 with <em>lūdēbat</em> — play is the dominant mode. This casual attitude masks immense artistic skill; it's the studied carelessness the neoterics cultivated.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The verb <em>lūsimus</em> ('we played') exemplifies neoteric poetic vocabulary, where <em>lūdere</em> describes artistic composition as playful leisure rather than serious labour. Its recurrence in <em>lūdēbat</em> (line 5) emphasises the ludic nature of this poetic exchange."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-tabellis">
            <div class="style-analysis-title">Metonymy — tabellīs</div>
            <div class="style-analysis-lines">Line 2</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> <em>Tabellae</em> are wax tablets — the Roman equivalent of a notepad. They literally "played on" these tablets, writing verses back and forth. The metonymy (tablets for poetry) grounds the abstract poetic activity in physical reality. You can almost see them, sitting there, scratching verses into wax with their styli.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The metonymy <em>in meīs tabellīs</em> ('on my tablets') grounds the poetic activity in material reality. The wax tablets serve as the medium for their impromptu poetic competition, giving concrete form to literary play."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-delicatos">
            <div class="style-analysis-title">Neoteric Term — dēlicātōs</div>
            <div class="style-analysis-lines">Line 3</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> <em>Dēlicātōs</em> means "refined, elegant, frivolous" — it's another loaded neoteric term. Being <em>dēlicātus</em> isn't a flaw; it's an aspiration. It's the aesthetic of the refined elite who value wit over weighty epic. "As it had suited us to be frivolous" — they chose this mode deliberately. It's a lifestyle statement disguised as an offhand remark.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The adjective <em>dēlicātōs</em> ('refined/frivolous') is a key neoteric value term, denoting the cultivated elegance prized by Catullus's circle. The phrase <em>ut convēnerat esse dēlicātōs</em> presents this aesthetic choice as a mutual agreement, a shared literary programme."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-versiculos">
            <div class="style-analysis-title">Diminutive — versiculōs</div>
            <div class="style-analysis-lines">Line 4</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> Not <em>versūs</em> ("verses") but <em>versiculōs</em> ("little verses, trivial verses"). Catullus loves his diminutives — they're cute, affectionate, self-deprecating. Calling his poetry "trivial little verses" is false modesty, of course, but it signals the neoteric preference for short, polished poems over epic bombast. Small is beautiful.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The diminutive <em>versiculōs</em> ('little verses') exemplifies Catullan self-deprecation while encoding neoteric aesthetic values: the preference for short, polished poetry (<em>lepos</em>) over grand epic. The diminutive form adds affectionate intimacy."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-modo">
            <div class="style-analysis-title">Anaphora — modo... modo</div>
            <div class="style-analysis-lines">Line 5</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "Now... now" — the repetition captures the back-and-forth energy of their poetic game. They're switching metres, trading verses, bouncing ideas. The anaphora mimics the rhythm of their exchange: now this metre, now that one. You can feel the playful competition, the quickfire creativity.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The anaphora <em>modo... modo</em> ('now... now') rhythmically enacts the alternation between metres, capturing the dynamic, improvisational quality of their poetic exchange. The repetition itself becomes a form of play."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-iocum-vinum">
            <div class="style-analysis-title">Hendiadys — per iocum atque vīnum</div>
            <div class="style-analysis-lines">Line 6</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "Amid jokes and wine" — two nouns linked by "and," but really describing a single atmosphere of convivial merriment. Wine-fuelled wit is the setting for their poetry session. It's a snapshot of the neoteric social world: friends, wine, wordplay. The symposium as creative space.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The hendiadys <em>per iocum atque vīnum</em> ('amid jokes and wine') evokes the sympotic setting of neoteric literary culture, where conviviality and creativity intertwine. The phrase establishes the social context for their poetic exchange."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-lepore">
            <div class="style-analysis-title">Neoteric Term — lepōre</div>
            <div class="style-analysis-lines">Line 7</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> <em>Lepos</em> is THE neoteric buzzword — charm, wit, elegance, grace. It's what makes poetry good. Calvus has it in spades, apparently. "Your <em>lepos</em>" isn't just complimenting his friend's personality; it's praising his poetic excellence. This is literary criticism disguised as affection.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The term <em>lepōre</em> ('charm, wit') is a programmatic neoteric aesthetic term, denoting the refined elegance valued in both social behaviour and poetic style. Attributing <em>lepos</em> to Calvus praises both the man and his poetry."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-incensus">
            <div class="style-analysis-title">Erotic Metaphor — incēnsus</div>
            <div class="style-analysis-lines">Line 8</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "Fired, inflamed" — hold on, that's love-language! <em>Incēnsus</em> is what you are when you're burning with passion for a lover. But this is about a friend, a male friend. Catullus deliberately blurs the line between friendship and eros. His affection for Calvus is expressed in terms usually reserved for Lesbia. Bromance or romance? Both, perhaps.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The participle <em>incēnsus</em> ('inflamed') imports erotic vocabulary into the description of male friendship. This deliberate blurring of amatory and amicable registers elevates Catullus's intellectual bond with Calvus to the intensity of erotic passion."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-facetiis">
            <div class="style-analysis-title">Neoteric Term — facetiīs</div>
            <div class="style-analysis-lines">Line 8</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> <em>Facētiae</em> — "witticisms, clever remarks" — another neoteric value term. Paired with <em>lepos</em>, it completes the picture of Calvus as the ideal neoteric companion: charming AND clever. These two qualities — grace and wit — are what the neoterics lived for.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The noun <em>facetiīs</em> ('witticisms'), paired with <em>lepōre</em> ('charm'), completes the neoteric value system: elegant grace combined with intellectual wit. Together they define the ideal qualities of both poet and poetry."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-miserum">
            <div class="style-analysis-title">Dramatic Self-Pity — miserum</div>
            <div class="style-analysis-lines">Line 9</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> "Wretched me!" — Catullus is being delightfully over-the-top. He can't eat, he can't sleep, all because of one evening's poetry session with a friend. The drama is ironic but also sincere. This is the Catullan persona: intensely emotional, performatively vulnerable. <em>Miser</em> is one of his favourite words about himself.
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The accusative <em>mē miserum</em> ('wretched me') exemplifies Catullus's characteristic self-dramatisation. The exaggerated suffering — inability to eat or sleep — elevates intellectual stimulation to the level of erotic torment."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-ocellos">
            <div class="style-analysis-title">Diminutive — ocellōs</div>
            <div class="style-analysis-lines">Line 10</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> Not <em>oculōs</em> ("eyes") but <em>ocellōs</em> ("dear little eyes"). Another diminutive, and a typically Catullan one. His eyes are precious, delicate, vulnerable — and now sleep won't cover them. The diminutive adds tenderness and pathos. Poor sleepless Catullus with his dear little eyes!
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The diminutive <em>ocellōs</em> ('dear little eyes') adds affective colouring, intensifying the pathos of Catullus's sleeplessness. The tender diminutive transforms insomnia into something precious and vulnerable."
            </div>
        </div>
        
        <div class="style-analysis" id="analysis-chiasmus">
            <div class="style-analysis-title">Chiasmus — nec... nec clauses</div>
            <div class="style-analysis-lines">Lines 9-10</div>
            <div class="style-analysis-effect">
                <strong>What's happening:</strong> Look at the word order here — it's beautifully arranged. In the first clause we get Object (<em>mē miserum</em>) then Subject+Verb (<em>cibus iuvāret</em>). In the second clause it's reversed: Subject+Verb (<em>somnus tegeret</em>) then Object (<em>ocellōs</em>). The two clauses mirror each other in an X-pattern — that's chiasmus. It's like Catullus is tossing and turning in the very structure of his sentences, restless even in his syntax!
            </div>
            <div class="style-analysis-exam">
                <strong>In an exam:</strong> "The parallel <em>nec... nec</em> clauses display chiasmus: Object–Subject–Verb (<em>mē miserum cibus iuvāret</em>) is reversed to Subject–Verb–Object (<em>somnus tegeret ocellōs</em>). This interlocking word order (ABBA pattern) creates syntactic balance while enacting the restless back-and-forth of Catullus's sleeplessness."
            </div>
        </div>
    </div>
    
    <script>
        let currentStep = 0;
        let coloursHidden = false;
        const activeCategories = new Set();
        
        const wordOrders = [];
        document.querySelectorAll('.latin-column .word-group').forEach(group => {
            if (group.dataset.order) {
                wordOrders.push(group.dataset.order);
            }
        });
        wordOrders.sort((a, b) => {
            const [lineA, numA] = a.split('-');
            const [lineB, numB] = b.split('-');
            if (lineA !== lineB) return parseInt(lineA) - parseInt(lineB);
            return parseInt(numA) - parseInt(numB);
        });
        
        function revealWord(order) {
            const latinGroups = document.querySelectorAll(`.latin-column .word-group[data-order="${order}"]`);
            latinGroups.forEach(group => {
                group.classList.add('revealed');
            });
            
            document.querySelectorAll(`.english-word`).forEach(word => {
                if (word.dataset.order) {
                    const orders = word.dataset.order.split(',');
                    if (orders.includes(order)) {
                        word.classList.add('revealed');
                    }
                }
            });
        }
        
        function hideWord(order) {
            const latinGroups = document.querySelectorAll(`.latin-column .word-group[data-order="${order}"]`);
            latinGroups.forEach(group => {
                group.classList.remove('revealed');
            });
            
            document.querySelectorAll(`.english-word`).forEach(word => {
                if (word.dataset.order) {
                    const orders = word.dataset.order.split(',');
                    if (orders.includes(order)) {
                        word.classList.remove('revealed');
                    }
                }
            });
        }
        
        function toggleWord(order) {
            const latinGroup = document.querySelector(`.latin-column .word-group[data-order="${order}"]`);
            if (latinGroup && latinGroup.classList.contains('revealed')) {
                hideWord(order);
            } else {
                revealWord(order);
            }
        }
        
        function stepForward() {
            if (currentStep < wordOrders.length) {
                revealWord(wordOrders[currentStep]);
                currentStep++;
            }
        }
        
        function stepBackward() {
            if (currentStep > 0) {
                currentStep--;
                hideWord(wordOrders[currentStep]);
            }
        }
        
        function toggleCategory(category) {
            const keyItem = document.querySelector(`.key-item[data-category="${category}"]`);
            
            if (activeCategories.has(category)) {
                activeCategories.delete(category);
                keyItem.classList.remove('active');
                
                document.querySelectorAll(`.latin-column .word-group.${category}`).forEach(group => {
                    group.classList.remove('highlighted');
                });
                
                document.querySelectorAll(`.english-word.${category}`).forEach(word => {
                    word.classList.remove('highlighted');
                });
            } else {
                activeCategories.add(category);
                keyItem.classList.add('active');
                
                document.querySelectorAll(`.latin-column .word-group.${category}`).forEach(group => {
                    group.classList.add('highlighted');
                });
                
                document.querySelectorAll(`.english-word.${category}`).forEach(word => {
                    word.classList.add('highlighted');
                });
            }
        }
        
        document.getElementById('showAllBtn').addEventListener('click', () => {
            document.querySelectorAll('.latin-column .word-group').forEach(group => {
                if (group.dataset.order) {
                    revealWord(group.dataset.order);
                }
            });
            currentStep = wordOrders.length;
        });
        
        document.getElementById('hideAllBtn').addEventListener('click', () => {
            document.querySelectorAll('.revealed').forEach(el => {
                el.classList.remove('revealed');
            });
            document.querySelectorAll('.english-word').forEach(el => {
                el.classList.remove('revealed');
            });
            document.querySelectorAll('.highlighted').forEach(el => {
                el.classList.remove('highlighted');
            });
            document.querySelectorAll('.key-item').forEach(el => {
                el.classList.remove('active');
            });
            activeCategories.clear();
            currentStep = 0;
        });
        
        document.getElementById('toggleColoursBtn').addEventListener('click', () => {
            coloursHidden = !coloursHidden;
            document.body.classList.toggle('hide-colours', coloursHidden);
            document.getElementById('toggleColoursBtn').textContent = 
                coloursHidden ? 'Show Colours' : 'Hide Colours';
        });
        
        document.querySelectorAll('.key-item').forEach(item => {
            item.addEventListener('click', () => {
                toggleCategory(item.dataset.category);
            });
        });
        
        document.querySelectorAll('.latin-column .word-group').forEach(group => {
            group.addEventListener('click', () => {
                if (group.dataset.order) {
                    toggleWord(group.dataset.order);
                }
            });
        });
        
        document.querySelectorAll('.english-word').forEach(word => {
            word.addEventListener('click', () => {
                if (word.dataset.order) {
                    const order = word.dataset.order.split(',')[0];
                    toggleWord(order);
                }
            });
        });
        
        document.querySelectorAll('.english-column .line-number').forEach(lineNum => {
            lineNum.style.cursor = 'pointer';
            lineNum.addEventListener('click', () => {
                const lineRow = lineNum.closest('.line-row');
                const lineOrders = [];
                lineRow.querySelectorAll('.english-word').forEach(word => {
                    if (word.dataset.order) {
                        word.dataset.order.split(',').forEach(order => {
                            if (!lineOrders.includes(order)) {
                                lineOrders.push(order);
                            }
                        });
                    }
                });
                
                const firstWord = lineRow.querySelector('.english-word');
                const isRevealed = firstWord && firstWord.classList.contains('revealed');
                
                lineOrders.forEach(order => {
                    if (isRevealed) {
                        hideWord(order);
                    } else {
                        revealWord(order);
                    }
                });
            });
        });
        
        document.getElementById('toggleStyleBtn').addEventListener('click', () => {
            document.body.classList.toggle('style-mode');
            const isStyleMode = document.body.classList.contains('style-mode');
            document.getElementById('toggleStyleBtn').textContent = 
                isStyleMode ? 'Hide Style' : 'Style Notes';
            
            if (!isStyleMode) {
                document.querySelectorAll('.style-tag.active').forEach(tag => {
                    tag.classList.remove('active');
                });
                document.querySelectorAll('.style-analysis.active').forEach(analysis => {
                    analysis.classList.remove('active');
                });
                document.querySelectorAll('.active-style').forEach(el => {
                    el.classList.remove('active-style');
                });
            }
        });
        
        document.querySelectorAll('.style-tag').forEach(tag => {
            tag.addEventListener('click', () => {
                const featureId = tag.dataset.feature;
                const isActive = tag.classList.contains('active');
                
                document.querySelectorAll('.style-tag.active').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.style-analysis.active').forEach(a => a.classList.remove('active'));
                document.querySelectorAll('.active-style').forEach(el => el.classList.remove('active-style'));
                
                if (!isActive) {
                    tag.classList.add('active');
                    
                    const analysis = document.getElementById('analysis-' + featureId);
                    if (analysis) {
                        analysis.classList.add('active');
                    }
                    
                    document.querySelectorAll('[data-style-feature]').forEach(el => {
                        const features = el.dataset.styleFeature.split(' ');
                        if (features.includes(featureId)) {
                            el.classList.add('active-style');
                        }
                    });
                }
            });
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.code === 'ArrowRight' || e.code === 'ArrowDown' || e.code === 'PageDown' || e.code === 'Space' || e.code === 'Enter') {
                e.preventDefault();
                stepForward();
            }
            else if (e.code === 'ArrowLeft' || e.code === 'ArrowUp' || e.code === 'PageUp' || e.code === 'Backspace') {
                e.preventDefault();
                stepBackward();
            }
            else if (e.code === 'Escape' || e.code === 'KeyR') {
                document.getElementById('hideAllBtn').click();
            }
        });
    </script>
</body>
</html>
